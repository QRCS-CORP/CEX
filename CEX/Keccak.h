// The GPL version 3 License (GPLv3)
// 
// Copyright (c) 2023 QSCS.ca
// This file is part of the CEX Cryptographic library.
// 
// This program is free software : you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
// 
// This program is distributed in the hope that it will be useful,
// but WITStateOUT ANY WARRANTY; without even the implied warranty of
// MERCStateANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.See the
// GNU General Public License for more details.
// 
// You should have received a copy of the GNU General Public License
// along with this program. If not, see <http://www.gnu.org/licenses/>.

#ifndef CEX_KECCAK_H
#define CEX_KECCAK_H

#include "CexDomain.h"
#include "IntegerTools.h"
#include "MemoryTools.h"

#if defined(CEX_HAS_AVX512)
#	include "ULong512.h"
#elif defined(CEX_HAS_AVX2)
#	include "ULong256.h"
#endif

NAMESPACE_DIGEST

using Tools::IntegerTools;
using Tools::MemoryTools;

#if defined(CEX_HAS_AVX512)
	using Numeric::ULong512;
#elif defined(CEX_HAS_AVX2)
	using Numeric::ULong256;
#endif

/// <summary>
/// Internal static class containing the 24 and 48 round Keccak permutation functions.
/// <para>The function names are in the format; Permute-rounds-bits-suffix, ex. PermuteR24P1600C, 24 rounds, permutes 1600 bits, using the compact form of the function. \n
/// Note: The PermuteR48P1600U is an extended permutation function that uses 48 rounds, rather than the 24 rounds used by the standard implementation of Keccak. \n
/// The additional 24 rounds constants were generated using the LFSR from the Keccak code package, with the additional 24 constants being \n
/// the next in sequence generated by that LFSR.</para>
/// <para>The compact forms of the permutations have the suffix C, and are optimized for low memory consumption 
/// (enabled in the hash function by adding the CEX_DIGEST_COMPACT to the CexConfig file). \n
/// The Unrolled forms are optimized for speed and timing neutrality have the U suffix. \n
/// The H suffix denotes functions that take an SIMD wrapper class as the state values, and process message blocks in SIMD parallel blocks.</para>
/// <para>This class contains wide forms of the functions; PermuteR24P4x1600H and PermuteR48P4x1600H use AVX2. \n
/// Experimental functions using AVX512 instructions are also implemented; PermuteR24P8x1600H and PermuteR48P8x1600H. \n
/// These extended functions are only visible at run-time on some development platforms (VS..), if the __AVX2__ or __AVX512__ compiler flags are declared explicitly.</para>
/// </summary>
class Keccak
{
// Keccak 1024 round constants enum:
// Generated using the InitializeRoundConstants/LFSR86540 function from the keccak code package:
// https://github.com/gvanas/KeccakCodePackage/blob/aa3cded0ae844dbff0dbecfb6d42d50c7bdb9d9b/SnP/KeccakP-1600/Reference/KeccakP-1600-reference.c
// The first 24 are the standard constants, the second set was generated by extending the LFSR to generate 48 round constants
//const uint64_t RC[48] =
//{
//	0x0000000000000001, 0x0000000000008082, 0x800000000000808A, 0x8000000080008000,
//	0x000000000000808B, 0x0000000080000001, 0x8000000080008081, 0x8000000000008009,
//	0x000000000000008A, 0x0000000000000088, 0x0000000080008009, 0x000000008000000A,
//	0x000000008000808B, 0x800000000000008B, 0x8000000000008089, 0x8000000000008003,
//	0x8000000000008002, 0x8000000000000080, 0x000000000000800A, 0x800000008000000A,
//	0x8000000080008081, 0x8000000000008080, 0x0000000080000001, 0x8000000080008008,
//  // next sequence generated using LFSR86540
//	0x8000000080008082, 0x800000008000800A, 0x8000000000000003, 0x8000000080000009,
//	0x8000000000008082, 0x0000000000008009, 0x8000000000000080, 0x0000000000008083,
//	0x8000000000000081, 0x0000000000000001, 0x000000000000800B, 0x8000000080008001,
//	0x0000000000000080, 0x8000000000008000, 0x8000000080008001, 0x0000000000000009,
//	0x800000008000808B, 0x0000000000000081, 0x8000000000000082, 0x000000008000008B,
//	0x8000000080008009, 0x8000000080000000, 0x0000000080000080, 0x0000000080008003
//};

public:

	/// <summary>
	/// The round constants for the standard 24-round implementation of the Keccak permutation
	/// </summary>
	static const std::array<uint64_t, 24> KECCAK_RC24;

	/// <summary>
	/// The round constants for the extended 48-round implementation of the Keccak permutation
	/// </summary>
	static const std::array<uint64_t, 48> KECCAK_RC48;

	/// <summary>
	/// The Keccak cSHAKE domain identifier
	/// </summary>
	static const uint8_t KECCAK_CSHAKE_DOMAIN = 0x04;

	/// <summary>
	/// The Keccak KMAC domain identifier
	/// </summary>
	static const uint8_t KECCAK_KMAC_DOMAIN = 0x04;

	/// <summary>
	/// The Keccak Parallel Authentication domain identifier
	/// </summary>
	static const uint8_t KECCAK_KPA_DOMAIN_ID = 0x41;

	/// <summary>
	/// The Keccak SHA3 digest domain identifier
	/// </summary>
	static const uint8_t KECCAK_SHA3_DOMAIN = 0x06;

	/// <summary>
	/// The Keccak SHAKE domain identifier
	/// </summary>
	static const uint8_t KECCAK_SHAKE_DOMAIN = 0x1F;

	/// <summary>
	/// The Keccak custom 4x-wide cSHAKE domain identifier
	/// </summary>
	static const uint8_t KECCAK_CSHAKEW4_DOMAIN = 0x21;

	/// <summary>
	/// The Keccak custom 8x-wide cSHAKE domain identifier
	/// </summary>
	static const uint8_t KECCAK_CSHAKEW8_DOMAIN = 0x22;

	/// <summary>
	/// The SHA3-128 digest output hash size in bytes
	/// </summary>
	static const size_t KECCAK128_DIGEST_SIZE = 16;

	/// <summary>
	/// The SHA3-256 digest output hash size in bytes
	/// </summary>
	static const size_t KECCAK256_DIGEST_SIZE = 32;

	/// <summary>
	/// The SHA3-512 digest output hash size in bytes
	/// </summary>
	static const size_t KECCAK512_DIGEST_SIZE = 64;

	/// <summary>
	/// The Keccak-128 input rate size in bytes
	/// </summary>
	static const size_t KECCAK128_RATE_SIZE = 168;

	/// <summary>
	/// The Keccak-256 input rate size in bytes
	/// </summary>
	static const size_t KECCAK256_RATE_SIZE = 136;

	/// <summary>
	/// The Keccak-512 input rate size in bytes
	/// </summary>
	static const size_t KECCAK512_RATE_SIZE = 72;

	/// <summary>
	/// The Keccak-1024 input rate size in bytes
	/// </summary>
	static const size_t KECCAK1024_RATE_SIZE = 32;

	/// <summary>
	/// The Keccak state size in 64-bit integers
	/// </summary>
	static const size_t KECCAK_STATE_SIZE = 25;
	
	/// <summary>
	/// The Keccak state size in 8-bit integers
	/// </summary>
	static const size_t KECCAK_STATE_BYTE_SIZE = 200;

	
	/// <summary>
	/// The number of rounds processed by the Keccak permutation function.
	/// <para>Rounds must be multiples of 12, using a range of { 12, 24, 36, 48 }.
	/// Used in the RN functions, and along with the Rate parameter, 
	/// can be used to vary the amount of mixing done by the transform, 
	/// and customize the security level.<para/>
	/// </summary>
	enum class PermutationRounds : size_t
	{
		/// <summary>
		/// No rounds are specified
		/// </summary>
		None = 0,
		/// <summary>
		/// Twelve rounds, the minimum level of security.
		/// </summary>
		RX12 = 12,
		/// <summary>
		/// Twenty-four rounds, the standard as specified in SHA3
		/// </summary>
		RX24 = 24,
		/// <summary>
		/// Thirty-six rounds, a custom setting
		/// </summary>
		RX36 = 36,
		/// <summary>
		/// Forty-eight rounds, the maximum
		/// </summary>
		RX48 = 48,
	};

	/// <summary>
	/// The Keccak absorb function; copy bytes from a uint8_t array to the state array.
	/// </summary>
	/// 
	/// <param name="Input">The input uint8_t array, can be either an 8-bit array or vector</param>
	/// <param name="InOffset">The starting offset withing the input array</param>
	/// <param name="InLength">The number of bytes to process; must be 64-bit aligned</param>
	/// <param name="Rate">The Keccak aborbtion rate in bytes</param>
	/// <param name="Domain">The Keccak implementation domain</param>
	/// <param name="State">The permutations uint64 state array</param>
	/// <param name="Rounds">The number of transformation rounds, the default is 24</param>
	template<typename ArrayU8, typename ArrayU64x25>
	static void Absorb(const ArrayU8 &Input, size_t InOffset, size_t InLength, size_t Rate, uint8_t Domain, ArrayU64x25 &State, PermutationRounds Rounds = PermutationRounds::RX24)
	{
		std::array<uint8_t, KECCAK_STATE_BYTE_SIZE> msg = { 0 };

		while (InLength >= Rate)
		{
			FastAbsorb(Input, InOffset, Rate, State);
			Permute(State, Rounds);

			InLength -= Rate;
			InOffset += Rate;
		}

		MemoryTools::Copy(Input, InOffset, msg, 0, InLength);
		msg[InLength] = Domain;
		msg[Rate - 1] |= 128;

#if defined(CEX_IS_LITTLE_ENDIAN)
		MemoryTools::XOR(msg, 0, State, 0, Rate);
#else
		for (i = 0; i < (Rate >> 3); ++i)
		{
			State[i] ^= IntegerTools::LeBytesTo64(msg, (8 * i));
		}
#endif
	}

	/// <summary>
	/// Incrementally absorb bytes into the state
	/// </summary>
	/// 
	/// <param name="Input">The input uint8_t array, can be either an 8-bit array or vector</param>
	/// <param name="InOffset">The starting offset withing the input array</param>
	/// <param name="InLength">The number of bytes to process</param>
	/// <param name="Position">The uint8_t position in the state</param>
	/// <param name="Rate">The Keccak aborbtion rate in bytes</param>
	/// <param name="State">The permutations uint64 state array</param>
	/// <param name="Rounds">The number of transformation rounds, the default is 24</param>
	template<typename ArrayU8, typename ArrayU64x25>
	static size_t Incremental(const ArrayU8 &Input, size_t InOffset, size_t InLength, size_t Position, size_t Rate, uint8_t Domain, ArrayU64x25 &State, bool Final = false, PermutationRounds Rounds = PermutationRounds::RX24)
	{
		std::array<uint8_t, 8> t = { 0 };
		size_t i;

		if ((Position & 7) > 0)
		{
			i = Position & 7;

			while (i < 8 && InLength > 0)
			{
				t[i] = Input[InOffset];
				++InOffset;
				++i;
				--InLength;
				++Position;
			}

			State[(Position - i) / 8] ^= IntegerTools::LeBytesTo64(t, 0);
		}

		if (Position && InLength >= Rate - Position)
		{
			for (i = 0; i < (Rate - Position) / 8; ++i)
			{
				State[(Position / 8) + i] ^= IntegerTools::LeBytesTo64(Input, InOffset + (8 * i));
			}

			InOffset += Rate - Position;
			InLength -= Rate - Position;
			Position = 0;
			Permute(State, Rounds);
		}

		while (InLength >= Rate)
		{
			for (i = 0; i < Rate / 8; i++)
			{
				State[i] ^= IntegerTools::LeBytesTo64(Input, InOffset + (8 * i));
			}

			InOffset += Rate;
			InLength -= Rate;
			Permute(State, Rounds);
		}

		for (i = 0; i < InLength / 8; ++i)
		{
			State[(Position / 8) + i] ^= IntegerTools::LeBytesTo64(Input, InOffset + (8 * i));
		}

		InOffset += 8 * i;
		InLength -= 8 * i;
		Position += 8 * i;

		if (InLength > 0)
		{
			for (i = 0; i < InLength; ++i)
			{
				t[i] = Input[InOffset + i];
			}

			State[Position / 8] ^= IntegerTools::LeBytesTo64(t, 0);
			Position += InLength;
		}

		if (Final == true)
		{
			size_t j;

			i = Position >> 3;
			j = Position & 7;
			State[i] ^= (static_cast<uint64_t>(Domain) << (8 * j));
			State[(Rate / 8) - 1] ^= 1ULL << 63;
		}

		return Position;
	}

	/// <summary>
	/// A compact (stateless) form of the Keccak message digest function (SHA3) using the standard 24 rounds; processes a message, and return the hash in the output array.
	/// <para>Set the Rate parameter to match the desired SHA3 function; 128, 256, or 512-bit hash function.</para>
	/// </summary>
	/// 
	/// <param name="Input">The message input uint8_t message array, can be either a standard array or vector</param>
	/// <param name="InOffset">The starting offset within the message uint8_t array</param>
	/// <param name="InLength">The number of message bytes to process</param>
	/// <param name="Output">The output hash array; returns a hash the size of the SHA3 mode, set by the Rate parameter; 16, 32, or 64 bytes</param>
	/// <param name="OutOffset">The starting offset within the output uint8_t array</param>
	/// <param name="Rate">The block input rate of permutation calls; SHAKE128=168, SHAKE256=136, SHAKE512=72</param>
	/// <param name="Rounds">The number of transformation rounds, the default is 24</param>
	template<typename ArrayU8A, typename ArrayU8B>
	static void Compute(const ArrayU8A &Input, size_t InOffset, size_t InLength, ArrayU8B &Output, size_t OutOffset, size_t Rate, PermutationRounds Rounds = PermutationRounds::RX24)
	{
		std::array<uint64_t, KECCAK_STATE_SIZE> state = { 0 };
		std::vector<uint8_t> hash(KECCAK256_DIGEST_SIZE);
		const size_t OTPLEN = ((KECCAK_STATE_SIZE * sizeof(uint64_t)) - Rate) / 2;

		Absorb(Input, InOffset, InLength, Rate, KECCAK_SHA3_DOMAIN, state, Rounds);
		Permute(state, Rounds);

		MemoryTools::Copy(state, 0, Output, OutOffset, OTPLEN);
	}

	/// <summary>
	/// Absorbs customization and name strings into the state
	/// </summary>
	/// 
	/// <param name="Customization">The input uint8_t message array, can be either a standard array or vector</param>
	/// <param name="Name">The starting offseet within the message uint8_t array</param>
	/// <param name="Rate">The block input rate of permutation calls; SHAKE128=168, SHAKE256=136, SHAKE512=72</param>
	/// <param name="State">The permutations uint64 state array</param>
	/// <param name="Rounds">The number of transformation rounds, the default is 24</param>
	template<typename ArrayU8, typename ArrayU64x25>
	static void Customize(const ArrayU8 &Customization, const ArrayU8 &Name, size_t Rate, ArrayU64x25 &State, PermutationRounds Rounds = PermutationRounds::RX24)
	{
		std::array<uint8_t, KECCAK_STATE_BYTE_SIZE> pad = { 0 };
		size_t i;
		size_t offset;

		offset = LeftEncode(pad, 0, static_cast<uint64_t>(Rate));
		offset += LeftEncode(pad, offset, static_cast<uint64_t>(Name.size()) * 8);

		if (Name.size() != 0)
		{
			for (i = 0; i < Name.size(); ++i)
			{
				if (offset == Rate)
				{
					FastAbsorb(pad, 0, Rate, State);
					Permute(State, Rounds);
					offset = 0;
				}

				pad[offset] = Name[i];
				++offset;
			}
		}

		offset += LeftEncode(pad, offset, static_cast<uint64_t>(Customization.size()) * 8);

		if (Customization.size() != 0)
		{
			for (i = 0; i < Customization.size(); ++i)
			{
				if (offset == Rate)
				{
					FastAbsorb(pad, 0, Rate, State);
					Permute(State, Rounds);
					offset = 0;
				}

				pad[offset] = Customization[i];
				++offset;
			}
		}

		MemoryTools::Clear(pad, offset, pad.size() - offset);
		offset = (offset % sizeof(uint64_t) == 0) ? offset : offset + (sizeof(uint64_t) - (offset % sizeof(uint64_t)));
		MemoryTools::XOR(pad, 0, State, 0, offset);

		Permute(State, Rounds);
	}

	/// <summary>
	/// The Keccak custom XOF function (cSHAKE); process a key, customization and name strings and return a pseudo-random output array.
	/// <para>A compact form of the cSHAKE XOF function.</para>
	/// </summary>
	/// 
	/// <param name="Key">The input uint8_t key array, can be either a standard array or vector</param>
	/// <param name="Customization">The customization string; can be used to create a custom implementation of SHAKE</param>
	/// <param name="Name">The name string, optional; can be used to as a domain or algorithm identifier, creating unique output</param>
	/// <param name="Output">The input uint8_t seed array, can be either an 8-bit array or vector</param>
	/// <param name="Offset">The starting offset withing the output array</param>
	/// <param name="Length">The number of output bytes to produce</param>
	/// <param name="Rate">The block input rate of permutation calls; SHAKE128=168, SHAKE256=136, SHAKE512=72</param>
	/// <param name="Rounds">The number of transformation rounds, the default is 24</param>
	template<typename ArrayU8>
	static void CXOFP1600(const ArrayU8 &Key, const ArrayU8 &Customization, const ArrayU8 &Name, ArrayU8 &Output, size_t Offset, size_t Length, size_t Rate, PermutationRounds Rounds = PermutationRounds::RX24)
	{
		std::array<uint64_t, KECCAK_STATE_SIZE> state = { 0 };

		Customize(Customization, Name, Rate, state, Rounds);
		Absorb(Key, 0, Key.size(), Rate, KECCAK_CSHAKE_DOMAIN, state, Rounds);

		while (Length != 0)
		{
			const size_t DIFF = IntegerTools::Min(Rate, Length);
			Permute(state, Rounds);
			MemoryTools::Copy(state, 0, Output, Offset, DIFF);
			Offset += DIFF;
			Length -= DIFF;
		}
	}

	/// <summary>
	/// The fast absorb function; XOR an input uint8_t array with the state array, no other processing is performed.
	/// <para>Input length must be 64-bit aligned.</para>
	/// </summary>
	/// 
	/// <param name="Input">The input uint8_t array, can be either an 8-bit array or vector</param>
	/// <param name="InOffset">The starting offset withing the input array</param>
	/// <param name="InLength">The number of bytes to process; must be 64-bit aligned</param>
	/// <param name="State">The permutations uint64 state array</param>
	template<typename ArrayU8, typename ArrayU64x25>
	static void FastAbsorb(const ArrayU8 &Input, size_t InOffset, size_t InLength, ArrayU64x25 &State)
	{
		CEXASSERT(InLength % sizeof(uint64_t) == 0, "The input length is not 64-bit aligned");

#if defined(CEX_IS_LITTLE_ENDIAN)
		MemoryTools::XOR(Input, InOffset, State, 0, InLength);
#else
		for (size_t i = 0; i < InLength / sizeof(uint64_t); ++i)
		{
			State[i] ^= IntegerTools::LeBytesTo64(Input, InOffset + (i * sizeof(uint64_t)));
		}
#endif
	}

	/// <summary>
	/// Finalize the state and generate the output.
	/// </summary>
	/// 
	/// <param name="Output">The input uint8_t seed array, can be either an 8-bit array or vector</param>
	/// <param name="Offset">The starting offset withing the output array</param>
	/// <param name="Length">The number of output bytes to produce</param>
	/// <param name="Rate">The block input rate of permutation calls; SHAKE128=168, SHAKE256=136, SHAKE512=72</param>
	/// <param name="Domain">The Keccak implementation domain</param>
	/// <param name="State">The permutations uint64 state array</param>
	/// <param name="Rounds">The number of transformation rounds, the default is 24</param>
	template<typename ArrayU8, typename ArrayU64x25>
	static void Finalize(ArrayU8 &Output, size_t Offset, size_t Length, size_t Rate, uint8_t Domain, ArrayU64x25 &State, PermutationRounds Rounds = PermutationRounds::RX24)
	{
		std::array<uint8_t, sizeof(size_t) + 1> buf = { 0 };
		std::array<uint8_t, KECCAK_STATE_BYTE_SIZE> pad = {0};
		size_t bitlen;

		bitlen = RightEncode(buf, 0, Length * 8);
		MemoryTools::Copy(buf, 0, pad, 0, bitlen);

		pad[bitlen] = Domain;
		pad[Rate - 1] |= 128U;
		FastAbsorb(pad, 0, Rate, State);

		while (Length >= Rate)
		{
			Squeeze(State, pad, 0, 1, Rate);
			MemoryTools::Copy(pad, 0, Output, Offset, Rate);
			Offset += Rate;
			Length -= Rate;
		}

		if (Length > 0)
		{
			Squeeze(State, pad, 0, 1, Rate);
			MemoryTools::Copy(pad, 0, Output, Offset, Length);
		}
	}

	/// <summary>
	/// Keccak common function: Left encode a value onto an array
	/// </summary>
	/// 
	/// <param name="Output">The output integer array</param>
	/// <param name="Offset">The output array starting offest</param>
	/// <param name="Value">The value to remove</param>
	/// 
	/// <returns>The number of encoded bits</returns>
	template<typename ArrayU8>
	static uint64_t LeftEncode(ArrayU8 &Output, size_t Offset, uint64_t Value)
	{
		uint64_t i;
		uint64_t n;
		uint64_t v;

		for (v = Value, n = 0; (v > 0) && (n < sizeof(uint64_t)); ++n, v >>= 8)
		{
		}

		if (n == 0)
		{
			n = 1;
		}

		for (i = 1; i <= n; ++i)
		{
			Output[Offset + i] = static_cast<uint8_t>(Value >> (8 * (n - i)));
		}

		Output[Offset] = static_cast<uint8_t>(n);

		return (n + 1);
	}

	/// <summary>
	/// A compact (stateless) form of the message authentication code generator (KMAC), using the standard 24 round permutation.
	/// <para>Process a key, customization string, and a message, and output a keyed-hash output array.</para>
	/// </summary>
	/// 
	/// <param name="Key">The input uint8_t key array, can be either a standard array or vector</param>
	/// <param name="Customization">The customization string; can be used to create a custom implementation of KMAC</param>
	/// <param name="Message">The input uint8_t message array, can be either a standard array or vector</param>
	/// <param name="Offset">The starting offseet within the message uint8_t array</param>
	/// <param name="Length">The number of message bytes to process</param>
	/// <param name="Output">The output hash array; returns a hash the size of the KMAC mode, set by the Rate parameter; 16, 32, or 64 bytes</param>
	/// <param name="Rate">The block input rate of permutation calls; KMAC128=168, KMAC256=136, KMAC512=72</param>
	/// <param name="Rounds">The number of transformation rounds, the default is 24</param>
	template<typename ArrayU8A, typename ArrayU8B, typename ArrayU8C>
	static void MACP1600(const ArrayU8A &Key, const ArrayU8A &Customization, const ArrayU8B &Message, size_t Offset, size_t Length, ArrayU8C &Output, size_t Rate, PermutationRounds Rounds = PermutationRounds::RX24)
	{
		const std::vector<uint8_t> KNAME{ 0x4B, 0x4D, 0x41, 0x43 };
		std::array<uint64_t, KECCAK_STATE_SIZE> state = { 0 };
		std::array<uint8_t, KECCAK_STATE_BYTE_SIZE> pad = { 0 };
		uint64_t poft;
		size_t blen;
		size_t i;

		// add the customization
		Customize(Customization, KNAME, Rate, state, Rounds);
		
		// absorb the key
		poft = LeftEncode(pad, 0, static_cast<uint64_t>(Rate));
		poft += LeftEncode(pad, poft, static_cast<uint64_t>(Key.size()) * sizeof(uint64_t));

		if (Key.size() != 0)
		{
			for (i = 0; i < Key.size(); ++i)
			{
				if (poft == Rate)
				{
					FastAbsorb(pad, 0, Rate, state);
					Permute(state, Rounds);
					poft = 0;
				}

				pad[poft] = Key[i];
				++poft;
			}
		}

		MemoryTools::Clear(pad, poft, pad.size() - poft);
		poft = (poft % sizeof(uint64_t) == 0) ? poft : poft + (sizeof(uint64_t) - (poft % sizeof(uint64_t)));

		for (i = 0; i < poft; i += 8)
		{
			state[i / sizeof(uint64_t)] ^= IntegerTools::LeBytesTo64(pad, i);
		}

		Permute(state, Rounds);

		// loop through the message, absorbing it into the state
		while (Length >= Rate)
		{
			FastAbsorb(Message, Offset, Rate, state);
			Permute(state, Rounds);
			Length -= Rate;
			Offset += Rate;
		}

		if (Length != 0)
		{
			MemoryTools::Copy(Message, Offset, pad, 0, Length);
			MemoryTools::Clear(pad, Length, pad.size() - Length);
		}

		// add the remaining message bytes to the state and finalize
		blen = RightEncode(pad, Length, static_cast<uint64_t>(Output.size()) * sizeof(uint64_t));

		Length += blen;
		pad[Length] = KECCAK_KMAC_DOMAIN;
		pad[Rate - 1] |= 128;
		FastAbsorb(pad, 0, Rate, state);

		// output the hash
		Length = Output.size();
		Offset = 0;

		while (Length != 0)
		{
			const size_t DIFF = IntegerTools::Min(Rate, Length);
			Permute(state, Rounds);
			MemoryTools::Copy(state, 0, Output, Offset, DIFF);
			Offset += DIFF;
			Length -= DIFF;
		}
	}

	/// <summary>
	/// The compact form of the SHA3 permutation function.
	/// <para>This function has been optimized for a small memory consumption.</para>
	/// </summary>
	/// 
	/// <param name="State">The permutations uint64 state array</param>
	/// <param name="Rounds">The permutation round count</param>
	template<typename ArrayU64x25>
	static void Permute(ArrayU64x25 &State, PermutationRounds Rounds = PermutationRounds::RX24)
	{
		std::array<uint64_t, 25> A;
		std::array<uint64_t, 5> C;
		std::array<uint64_t, 5> D;
		std::array<uint64_t, 25> E;
		size_t i;

		MemoryTools::Copy(State, 0, A, 0, A.size() * sizeof(uint64_t));

		for (i = 0; i < static_cast<size_t>(Rounds); i += 2)
		{
			// round n
			C[0] = A[0] ^ A[5] ^ A[10] ^ A[15] ^ A[20];
			C[1] = A[1] ^ A[6] ^ A[11] ^ A[16] ^ A[21];
			C[2] = A[2] ^ A[7] ^ A[12] ^ A[17] ^ A[22];
			C[3] = A[3] ^ A[8] ^ A[13] ^ A[18] ^ A[23];
			C[4] = A[4] ^ A[9] ^ A[14] ^ A[19] ^ A[24];
			D[0] = C[4] ^ IntegerTools::RotFL64(C[1], 1);
			D[1] = C[0] ^ IntegerTools::RotFL64(C[2], 1);
			D[2] = C[1] ^ IntegerTools::RotFL64(C[3], 1);
			D[3] = C[2] ^ IntegerTools::RotFL64(C[4], 1);
			D[4] = C[3] ^ IntegerTools::RotFL64(C[0], 1);
			A[0] ^= D[0];
			C[0] = A[0];
			A[6] ^= D[1];
			C[1] = IntegerTools::RotFL64(A[6], 44);
			A[12] ^= D[2];
			C[2] = IntegerTools::RotFL64(A[12], 43);
			A[18] ^= D[3];
			C[3] = IntegerTools::RotFL64(A[18], 21);
			A[24] ^= D[4];
			C[4] = IntegerTools::RotFL64(A[24], 14);
			E[0] = C[0] ^ ((~C[1]) & C[2]);
			E[0] ^= KECCAK_RC48[i];
			E[1] = C[1] ^ ((~C[2]) & C[3]);
			E[2] = C[2] ^ ((~C[3]) & C[4]);
			E[3] = C[3] ^ ((~C[4]) & C[0]);
			E[4] = C[4] ^ ((~C[0]) & C[1]);
			A[3] ^= D[3];
			C[0] = IntegerTools::RotFL64(A[3], 28);
			A[9] ^= D[4];
			C[1] = IntegerTools::RotFL64(A[9], 20);
			A[10] ^= D[0];
			C[2] = IntegerTools::RotFL64(A[10], 3);
			A[16] ^= D[1];
			C[3] = IntegerTools::RotFL64(A[16], 45);
			A[22] ^= D[2];
			C[4] = IntegerTools::RotFL64(A[22], 61);
			E[5] = C[0] ^ ((~C[1]) & C[2]);
			E[6] = C[1] ^ ((~C[2]) & C[3]);
			E[7] = C[2] ^ ((~C[3]) & C[4]);
			E[8] = C[3] ^ ((~C[4]) & C[0]);
			E[9] = C[4] ^ ((~C[0]) & C[1]);
			A[1] ^= D[1];
			C[0] = IntegerTools::RotFL64(A[1], 1);
			A[7] ^= D[2];
			C[1] = IntegerTools::RotFL64(A[7], 6);
			A[13] ^= D[3];
			C[2] = IntegerTools::RotFL64(A[13], 25);
			A[19] ^= D[4];
			C[3] = IntegerTools::RotFL64(A[19], 8);
			A[20] ^= D[0];
			C[4] = IntegerTools::RotFL64(A[20], 18);
			E[10] = C[0] ^ ((~C[1]) & C[2]);
			E[11] = C[1] ^ ((~C[2]) & C[3]);
			E[12] = C[2] ^ ((~C[3]) & C[4]);
			E[13] = C[3] ^ ((~C[4]) & C[0]);
			E[14] = C[4] ^ ((~C[0]) & C[1]);
			A[4] ^= D[4];
			C[0] = IntegerTools::RotFL64(A[4], 27);
			A[5] ^= D[0];
			C[1] = IntegerTools::RotFL64(A[5], 36);
			A[11] ^= D[1];
			C[2] = IntegerTools::RotFL64(A[11], 10);
			A[17] ^= D[2];
			C[3] = IntegerTools::RotFL64(A[17], 15);
			A[23] ^= D[3];
			C[4] = IntegerTools::RotFL64(A[23], 56);
			E[15] = C[0] ^ ((~C[1]) & C[2]);
			E[16] = C[1] ^ ((~C[2]) & C[3]);
			E[17] = C[2] ^ ((~C[3]) & C[4]);
			E[18] = C[3] ^ ((~C[4]) & C[0]);
			E[19] = C[4] ^ ((~C[0]) & C[1]);
			A[2] ^= D[2];
			C[0] = IntegerTools::RotFL64(A[2], 62);
			A[8] ^= D[3];
			C[1] = IntegerTools::RotFL64(A[8], 55);
			A[14] ^= D[4];
			C[2] = IntegerTools::RotFL64(A[14], 39);
			A[15] ^= D[0];
			C[3] = IntegerTools::RotFL64(A[15], 41);
			A[21] ^= D[1];
			C[4] = IntegerTools::RotFL64(A[21], 2);
			E[20] = C[0] ^ ((~C[1]) & C[2]);
			E[21] = C[1] ^ ((~C[2]) & C[3]);
			E[22] = C[2] ^ ((~C[3]) & C[4]);
			E[23] = C[3] ^ ((~C[4]) & C[0]);
			E[24] = C[4] ^ ((~C[0]) & C[1]);
			// round n + 1
			C[0] = E[0] ^ E[5] ^ E[10] ^ E[15] ^ E[20];
			C[1] = E[1] ^ E[6] ^ E[11] ^ E[16] ^ E[21];
			C[2] = E[2] ^ E[7] ^ E[12] ^ E[17] ^ E[22];
			C[3] = E[3] ^ E[8] ^ E[13] ^ E[18] ^ E[23];
			C[4] = E[4] ^ E[9] ^ E[14] ^ E[19] ^ E[24];
			D[0] = C[4] ^ IntegerTools::RotFL64(C[1], 1);
			D[1] = C[0] ^ IntegerTools::RotFL64(C[2], 1);
			D[2] = C[1] ^ IntegerTools::RotFL64(C[3], 1);
			D[3] = C[2] ^ IntegerTools::RotFL64(C[4], 1);
			D[4] = C[3] ^ IntegerTools::RotFL64(C[0], 1);
			E[0] ^= D[0];
			C[0] = E[0];
			E[6] ^= D[1];
			C[1] = IntegerTools::RotFL64(E[6], 44);
			E[12] ^= D[2];
			C[2] = IntegerTools::RotFL64(E[12], 43);
			E[18] ^= D[3];
			C[3] = IntegerTools::RotFL64(E[18], 21);
			E[24] ^= D[4];
			C[4] = IntegerTools::RotFL64(E[24], 14);
			A[0] = C[0] ^ ((~C[1]) & C[2]);
			A[0] ^= KECCAK_RC48[i + 1];
			A[1] = C[1] ^ ((~C[2]) & C[3]);
			A[2] = C[2] ^ ((~C[3]) & C[4]);
			A[3] = C[3] ^ ((~C[4]) & C[0]);
			A[4] = C[4] ^ ((~C[0]) & C[1]);
			E[3] ^= D[3];
			C[0] = IntegerTools::RotFL64(E[3], 28);
			E[9] ^= D[4];
			C[1] = IntegerTools::RotFL64(E[9], 20);
			E[10] ^= D[0];
			C[2] = IntegerTools::RotFL64(E[10], 3);
			E[16] ^= D[1];
			C[3] = IntegerTools::RotFL64(E[16], 45);
			E[22] ^= D[2];
			C[4] = IntegerTools::RotFL64(E[22], 61);
			A[5] = C[0] ^ ((~C[1]) & C[2]);
			A[6] = C[1] ^ ((~C[2]) & C[3]);
			A[7] = C[2] ^ ((~C[3]) & C[4]);
			A[8] = C[3] ^ ((~C[4]) & C[0]);
			A[9] = C[4] ^ ((~C[0]) & C[1]);
			E[1] ^= D[1];
			C[0] = IntegerTools::RotFL64(E[1], 1);
			E[7] ^= D[2];
			C[1] = IntegerTools::RotFL64(E[7], 6);
			E[13] ^= D[3];
			C[2] = IntegerTools::RotFL64(E[13], 25);
			E[19] ^= D[4];
			C[3] = IntegerTools::RotFL64(E[19], 8);
			E[20] ^= D[0];
			C[4] = IntegerTools::RotFL64(E[20], 18);
			A[10] = C[0] ^ ((~C[1]) & C[2]);
			A[11] = C[1] ^ ((~C[2]) & C[3]);
			A[12] = C[2] ^ ((~C[3]) & C[4]);
			A[13] = C[3] ^ ((~C[4]) & C[0]);
			A[14] = C[4] ^ ((~C[0]) & C[1]);
			E[4] ^= D[4];
			C[0] = IntegerTools::RotFL64(E[4], 27);
			E[5] ^= D[0];
			C[1] = IntegerTools::RotFL64(E[5], 36);
			E[11] ^= D[1];
			C[2] = IntegerTools::RotFL64(E[11], 10);
			E[17] ^= D[2];
			C[3] = IntegerTools::RotFL64(E[17], 15);
			E[23] ^= D[3];
			C[4] = IntegerTools::RotFL64(E[23], 56);
			A[15] = C[0] ^ ((~C[1]) & C[2]);
			A[16] = C[1] ^ ((~C[2]) & C[3]);
			A[17] = C[2] ^ ((~C[3]) & C[4]);
			A[18] = C[3] ^ ((~C[4]) & C[0]);
			A[19] = C[4] ^ ((~C[0]) & C[1]);
			E[2] ^= D[2];
			C[0] = IntegerTools::RotFL64(E[2], 62);
			E[8] ^= D[3];
			C[1] = IntegerTools::RotFL64(E[8], 55);
			E[14] ^= D[4];
			C[2] = IntegerTools::RotFL64(E[14], 39);
			E[15] ^= D[0];
			C[3] = IntegerTools::RotFL64(E[15], 41);
			E[21] ^= D[1];
			C[4] = IntegerTools::RotFL64(E[21], 2);
			A[20] = C[0] ^ ((~C[1]) & C[2]);
			A[21] = C[1] ^ ((~C[2]) & C[3]);
			A[22] = C[2] ^ ((~C[3]) & C[4]);
			A[23] = C[3] ^ ((~C[4]) & C[0]);
			A[24] = C[4] ^ ((~C[0]) & C[1]);
		}

		MemoryTools::Copy(A, 0, State, 0, A.size() * sizeof(uint64_t));
	}

	/// <summary>
	/// The unrolled form of the 24 round (standard) SHA3 permutation function.
	/// <para>This function (the default) has been optimized for speed, and timing neutrality.</para>
	/// </summary>
	/// 
	/// <param name="State">The permutations uint64 state array</param>
	template<typename ArrayU64x25>
	static void PermuteR24P1600U(ArrayU64x25 &State)
	{
		uint64_t Aba;
		uint64_t Abe;
		uint64_t Abi;
		uint64_t Abo;
		uint64_t Abu;
		uint64_t Aga;
		uint64_t Age;
		uint64_t Agi;
		uint64_t Ago;
		uint64_t Agu;
		uint64_t Aka;
		uint64_t Ake;
		uint64_t Aki;
		uint64_t Ako;
		uint64_t Aku;
		uint64_t Ama;
		uint64_t Ame;
		uint64_t Ami;
		uint64_t Amo;
		uint64_t Amu;
		uint64_t Asa;
		uint64_t Ase;
		uint64_t Asi;
		uint64_t Aso;
		uint64_t Asu;
		uint64_t Ca;
		uint64_t Ce;
		uint64_t Ci;
		uint64_t Co;
		uint64_t Cu;
		uint64_t Da;
		uint64_t De;
		uint64_t Di;
		uint64_t Do;
		uint64_t Du;
		uint64_t Eba;
		uint64_t Ebe;
		uint64_t Ebi;
		uint64_t Ebo;
		uint64_t Ebu;
		uint64_t Ega;
		uint64_t Ege;
		uint64_t Egi;
		uint64_t Ego;
		uint64_t Egu;
		uint64_t Eka;
		uint64_t Eke;
		uint64_t Eki;
		uint64_t Eko;
		uint64_t Eku;
		uint64_t Ema;
		uint64_t Eme;
		uint64_t Emi;
		uint64_t Emo;
		uint64_t Emu;
		uint64_t Esa;
		uint64_t Ese;
		uint64_t Esi;
		uint64_t Eso;
		uint64_t Esu;

		Aba = State[0];
		Abe = State[1];
		Abi = State[2];
		Abo = State[3];
		Abu = State[4];
		Aga = State[5];
		Age = State[6];
		Agi = State[7];
		Ago = State[8];
		Agu = State[9];
		Aka = State[10];
		Ake = State[11];
		Aki = State[12];
		Ako = State[13];
		Aku = State[14];
		Ama = State[15];
		Ame = State[16];
		Ami = State[17];
		Amo = State[18];
		Amu = State[19];
		Asa = State[20];
		Ase = State[21];
		Asi = State[22];
		Aso = State[23];
		Asu = State[24];

		// round 1
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x0000000000000001ULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 2
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x0000000000008082ULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 3
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x800000000000808AULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 4
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x8000000080008000ULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 5
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x000000000000808BULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 6
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x0000000080000001ULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 7
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x8000000080008081ULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 8
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x8000000000008009ULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 9
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x000000000000008AULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 10
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x0000000000000088ULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 11
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x0000000080008009ULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 12
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x000000008000000AULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 13
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x000000008000808BULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 14
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x800000000000008BULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 15
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x8000000000008089ULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 16
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x8000000000008003ULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 17
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x8000000000008002ULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 18
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x8000000000000080ULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 19
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x000000000000800AULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 20
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x800000008000000AULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 21
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x8000000080008081ULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 22
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x8000000000008080ULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 23
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x0000000080000001ULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 24
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x8000000080008008ULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);

		State[0] = Aba;
		State[1] = Abe;
		State[2] = Abi;
		State[3] = Abo;
		State[4] = Abu;
		State[5] = Aga;
		State[6] = Age;
		State[7] = Agi;
		State[8] = Ago;
		State[9] = Agu;
		State[10] = Aka;
		State[11] = Ake;
		State[12] = Aki;
		State[13] = Ako;
		State[14] = Aku;
		State[15] = Ama;
		State[16] = Ame;
		State[17] = Ami;
		State[18] = Amo;
		State[19] = Amu;
		State[20] = Asa;
		State[21] = Ase;
		State[22] = Asi;
		State[23] = Aso;
		State[24] = Asu;
	}

	/// <summary>
	/// The unrolled form of the 48 round (extended) SHA3 permutation function.
	/// <para>This function (the default) has been optimized for speed, and timing neutrality.
	/// To enable this function, remove the CEX_DIGEST_COMPACT directive from the CexConfig file.</para>
	/// </summary>
	/// 
	/// <param name="State">The permutations uint64 state array</param>
	template<typename ArrayU64x25>
	static void PermuteR48P1600U(ArrayU64x25 &State)
	{
		uint64_t Aba;
		uint64_t Abe;
		uint64_t Abi;
		uint64_t Abo;
		uint64_t Abu;
		uint64_t Aga;
		uint64_t Age;
		uint64_t Agi;
		uint64_t Ago;
		uint64_t Agu;
		uint64_t Aka;
		uint64_t Ake;
		uint64_t Aki;
		uint64_t Ako;
		uint64_t Aku;
		uint64_t Ama;
		uint64_t Ame;
		uint64_t Ami;
		uint64_t Amo;
		uint64_t Amu;
		uint64_t Asa;
		uint64_t Ase;
		uint64_t Asi;
		uint64_t Aso;
		uint64_t Asu;
		uint64_t Ca;
		uint64_t Ce;
		uint64_t Ci;
		uint64_t Co;
		uint64_t Cu;
		uint64_t Da;
		uint64_t De;
		uint64_t Di;
		uint64_t Do;
		uint64_t Du;
		uint64_t Eba;
		uint64_t Ebe;
		uint64_t Ebi;
		uint64_t Ebo;
		uint64_t Ebu;
		uint64_t Ega;
		uint64_t Ege;
		uint64_t Egi;
		uint64_t Ego;
		uint64_t Egu;
		uint64_t Eka;
		uint64_t Eke;
		uint64_t Eki;
		uint64_t Eko;
		uint64_t Eku;
		uint64_t Ema;
		uint64_t Eme;
		uint64_t Emi;
		uint64_t Emo;
		uint64_t Emu;
		uint64_t Esa;
		uint64_t Ese;
		uint64_t Esi;
		uint64_t Eso;
		uint64_t Esu;

		Aba = State[0];
		Abe = State[1];
		Abi = State[2];
		Abo = State[3];
		Abu = State[4];
		Aga = State[5];
		Age = State[6];
		Agi = State[7];
		Ago = State[8];
		Agu = State[9];
		Aka = State[10];
		Ake = State[11];
		Aki = State[12];
		Ako = State[13];
		Aku = State[14];
		Ama = State[15];
		Ame = State[16];
		Ami = State[17];
		Amo = State[18];
		Amu = State[19];
		Asa = State[20];
		Ase = State[21];
		Asi = State[22];
		Aso = State[23];
		Asu = State[24];

		// round 1
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x0000000000000001ULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 2
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x0000000000008082ULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 3
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x800000000000808AULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 4
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x8000000080008000ULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 5
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x000000000000808BULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 6
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x0000000080000001ULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 7
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x8000000080008081ULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 8
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x8000000000008009ULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 9
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x000000000000008AULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 10
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x0000000000000088ULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 11
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x0000000080008009ULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 12
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x000000008000000AULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 13
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x000000008000808BULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 14
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x800000000000008BULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 15
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x8000000000008089ULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 16
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x8000000000008003ULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 17
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x8000000000008002ULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 18
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x8000000000000080ULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 19
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x000000000000800AULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 20
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x800000008000000AULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 21
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x8000000080008081ULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 22
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x8000000000008080ULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 23
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x0000000080000001ULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 24
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x8000000080008008ULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 25
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x8000000080008082ULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 26
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x800000008000800AULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 27
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x8000000000000003ULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 28
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x8000000080000009ULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 29
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x8000000000008082ULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 30
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x0000000000008009ULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 31
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x8000000000000080ULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 32
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x0000000000008083ULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 33
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x8000000000000081ULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 34
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x0000000000000001ULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 35
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x000000000000800BULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 36
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x8000000080008001ULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 37
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x0000000000000080ULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 38
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x8000000000008000ULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 39
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x8000000080008001ULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 40
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x0000000000000009ULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 41
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x800000008000808BULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 42
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x0000000000000081ULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 43
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x8000000000000082ULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 44
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x000000008000008BULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 45
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x8000000080008009ULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 46
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x8000000080000000ULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);
		// round 47
		Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
		Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
		Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
		Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
		Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Aba ^= Da;
		Ca = Aba;
		Age ^= De;
		Ce = IntegerTools::RotFL64(Age, 44);
		Aki ^= Di;
		Ci = IntegerTools::RotFL64(Aki, 43);
		Amo ^= Do;
		Co = IntegerTools::RotFL64(Amo, 21);
		Asu ^= Du;
		Cu = IntegerTools::RotFL64(Asu, 14);
		Eba = Ca ^ ((~Ce) & Ci);
		Eba ^= 0x0000000080000080ULL;
		Ebe = Ce ^ ((~Ci) & Co);
		Ebi = Ci ^ ((~Co) & Cu);
		Ebo = Co ^ ((~Cu) & Ca);
		Ebu = Cu ^ ((~Ca) & Ce);
		Abo ^= Do;
		Ca = IntegerTools::RotFL64(Abo, 28);
		Agu ^= Du;
		Ce = IntegerTools::RotFL64(Agu, 20);
		Aka ^= Da;
		Ci = IntegerTools::RotFL64(Aka, 3);
		Ame ^= De;
		Co = IntegerTools::RotFL64(Ame, 45);
		Asi ^= Di;
		Cu = IntegerTools::RotFL64(Asi, 61);
		Ega = Ca ^ ((~Ce) & Ci);
		Ege = Ce ^ ((~Ci) & Co);
		Egi = Ci ^ ((~Co) & Cu);
		Ego = Co ^ ((~Cu) & Ca);
		Egu = Cu ^ ((~Ca) & Ce);
		Abe ^= De;
		Ca = IntegerTools::RotFL64(Abe, 1);
		Agi ^= Di;
		Ce = IntegerTools::RotFL64(Agi, 6);
		Ako ^= Do;
		Ci = IntegerTools::RotFL64(Ako, 25);
		Amu ^= Du;
		Co = IntegerTools::RotFL64(Amu, 8);
		Asa ^= Da;
		Cu = IntegerTools::RotFL64(Asa, 18);
		Eka = Ca ^ ((~Ce) & Ci);
		Eke = Ce ^ ((~Ci) & Co);
		Eki = Ci ^ ((~Co) & Cu);
		Eko = Co ^ ((~Cu) & Ca);
		Eku = Cu ^ ((~Ca) & Ce);
		Abu ^= Du;
		Ca = IntegerTools::RotFL64(Abu, 27);
		Aga ^= Da;
		Ce = IntegerTools::RotFL64(Aga, 36);
		Ake ^= De;
		Ci = IntegerTools::RotFL64(Ake, 10);
		Ami ^= Di;
		Co = IntegerTools::RotFL64(Ami, 15);
		Aso ^= Do;
		Cu = IntegerTools::RotFL64(Aso, 56);
		Ema = Ca ^ ((~Ce) & Ci);
		Eme = Ce ^ ((~Ci) & Co);
		Emi = Ci ^ ((~Co) & Cu);
		Emo = Co ^ ((~Cu) & Ca);
		Emu = Cu ^ ((~Ca) & Ce);
		Abi ^= Di;
		Ca = IntegerTools::RotFL64(Abi, 62);
		Ago ^= Do;
		Ce = IntegerTools::RotFL64(Ago, 55);
		Aku ^= Du;
		Ci = IntegerTools::RotFL64(Aku, 39);
		Ama ^= Da;
		Co = IntegerTools::RotFL64(Ama, 41);
		Ase ^= De;
		Cu = IntegerTools::RotFL64(Ase, 2);
		Esa = Ca ^ ((~Ce) & Ci);
		Ese = Ce ^ ((~Ci) & Co);
		Esi = Ci ^ ((~Co) & Cu);
		Eso = Co ^ ((~Cu) & Ca);
		Esu = Cu ^ ((~Ca) & Ce);
		// round 48
		Ca = Eba ^ Ega ^ Eka ^ Ema ^ Esa;
		Ce = Ebe ^ Ege ^ Eke ^ Eme ^ Ese;
		Ci = Ebi ^ Egi ^ Eki ^ Emi ^ Esi;
		Co = Ebo ^ Ego ^ Eko ^ Emo ^ Eso;
		Cu = Ebu ^ Egu ^ Eku ^ Emu ^ Esu;
		Da = Cu ^ IntegerTools::RotFL64(Ce, 1);
		De = Ca ^ IntegerTools::RotFL64(Ci, 1);
		Di = Ce ^ IntegerTools::RotFL64(Co, 1);
		Do = Ci ^ IntegerTools::RotFL64(Cu, 1);
		Du = Co ^ IntegerTools::RotFL64(Ca, 1);
		Eba ^= Da;
		Ca = Eba;
		Ege ^= De;
		Ce = IntegerTools::RotFL64(Ege, 44);
		Eki ^= Di;
		Ci = IntegerTools::RotFL64(Eki, 43);
		Emo ^= Do;
		Co = IntegerTools::RotFL64(Emo, 21);
		Esu ^= Du;
		Cu = IntegerTools::RotFL64(Esu, 14);
		Aba = Ca ^ ((~Ce) & Ci);
		Aba ^= 0x0000000080008003ULL;
		Abe = Ce ^ ((~Ci) & Co);
		Abi = Ci ^ ((~Co) & Cu);
		Abo = Co ^ ((~Cu) & Ca);
		Abu = Cu ^ ((~Ca) & Ce);
		Ebo ^= Do;
		Ca = IntegerTools::RotFL64(Ebo, 28);
		Egu ^= Du;
		Ce = IntegerTools::RotFL64(Egu, 20);
		Eka ^= Da;
		Ci = IntegerTools::RotFL64(Eka, 3);
		Eme ^= De;
		Co = IntegerTools::RotFL64(Eme, 45);
		Esi ^= Di;
		Cu = IntegerTools::RotFL64(Esi, 61);
		Aga = Ca ^ ((~Ce) & Ci);
		Age = Ce ^ ((~Ci) & Co);
		Agi = Ci ^ ((~Co) & Cu);
		Ago = Co ^ ((~Cu) & Ca);
		Agu = Cu ^ ((~Ca) & Ce);
		Ebe ^= De;
		Ca = IntegerTools::RotFL64(Ebe, 1);
		Egi ^= Di;
		Ce = IntegerTools::RotFL64(Egi, 6);
		Eko ^= Do;
		Ci = IntegerTools::RotFL64(Eko, 25);
		Emu ^= Du;
		Co = IntegerTools::RotFL64(Emu, 8);
		Esa ^= Da;
		Cu = IntegerTools::RotFL64(Esa, 18);
		Aka = Ca ^ ((~Ce) & Ci);
		Ake = Ce ^ ((~Ci) & Co);
		Aki = Ci ^ ((~Co) & Cu);
		Ako = Co ^ ((~Cu) & Ca);
		Aku = Cu ^ ((~Ca) & Ce);
		Ebu ^= Du;
		Ca = IntegerTools::RotFL64(Ebu, 27);
		Ega ^= Da;
		Ce = IntegerTools::RotFL64(Ega, 36);
		Eke ^= De;
		Ci = IntegerTools::RotFL64(Eke, 10);
		Emi ^= Di;
		Co = IntegerTools::RotFL64(Emi, 15);
		Eso ^= Do;
		Cu = IntegerTools::RotFL64(Eso, 56);
		Ama = Ca ^ ((~Ce) & Ci);
		Ame = Ce ^ ((~Ci) & Co);
		Ami = Ci ^ ((~Co) & Cu);
		Amo = Co ^ ((~Cu) & Ca);
		Amu = Cu ^ ((~Ca) & Ce);
		Ebi ^= Di;
		Ca = IntegerTools::RotFL64(Ebi, 62);
		Ego ^= Do;
		Ce = IntegerTools::RotFL64(Ego, 55);
		Eku ^= Du;
		Ci = IntegerTools::RotFL64(Eku, 39);
		Ema ^= Da;
		Co = IntegerTools::RotFL64(Ema, 41);
		Ese ^= De;
		Cu = IntegerTools::RotFL64(Ese, 2);
		Asa = Ca ^ ((~Ce) & Ci);
		Ase = Ce ^ ((~Ci) & Co);
		Asi = Ci ^ ((~Co) & Cu);
		Aso = Co ^ ((~Cu) & Ca);
		Asu = Cu ^ ((~Ca) & Ce);

		State[0] = Aba;
		State[1] = Abe;
		State[2] = Abi;
		State[3] = Abo;
		State[4] = Abu;
		State[5] = Aga;
		State[6] = Age;
		State[7] = Agi;
		State[8] = Ago;
		State[9] = Agu;
		State[10] = Aka;
		State[11] = Ake;
		State[12] = Aki;
		State[13] = Ako;
		State[14] = Aku;
		State[15] = Ama;
		State[16] = Ame;
		State[17] = Ami;
		State[18] = Amo;
		State[19] = Amu;
		State[20] = Asa;
		State[21] = Ase;
		State[22] = Asi;
		State[23] = Aso;
		State[24] = Asu;
	}

#if defined(CEX_HAS_AVX512)

#define _mm512_extract_epi64x(b, i) ( \
        _mm_extract_epi64(_mm512_extracti64x2_epi64(b, i / 2), i % 2))

	template<typename ArrayU512>
	static void AbsorbR28x1600H(ArrayU512 &State,
		size_t Rate,
		const std::vector<uint8_t> &Input0, 
		const std::vector<uint8_t> &Input1, 
		const std::vector<uint8_t> &Input2, 
		const std::vector<uint8_t> &Input3, 
		const std::vector<uint8_t> &Input4,
		const std::vector<uint8_t> &Input5,
		const std::vector<uint8_t> &Input6,
		const std::vector<uint8_t> &Input7,
		size_t InputLength, 
		uint8_t Domain)
	{
		__m512i t;
		__m512i idx;
		int64_t p0;
		int64_t p1;
		int64_t p2;
		int64_t p3;
		int64_t p4;
		int64_t p5;
		int64_t p6;
		int64_t p7;
		size_t i;
		size_t pos;

		pos = 0;
		p0 = (int64_t)Input0.data();
		p1 = (int64_t)Input1.data();
		p2 = (int64_t)Input2.data();
		p3 = (int64_t)Input3.data();
		p4 = (int64_t)Input4.data();
		p5 = (int64_t)Input5.data();
		p6 = (int64_t)Input6.data();
		p7 = (int64_t)Input7.data();

		idx = _mm512_set_epi64(p7, p6, p5, p4, p3, p2, p1, p0);

		while (InputLength >= (size_t)rate)
		{
			for (i = 0; i < (size_t)Rate / sizeof(uint64_t); ++i)
			{
				t = _mm512_i64gather_epi64(idx, (int64_t*)pos, 1);
				State[i] = _mm512_xor_si512(State[i], t);
				pos += sizeof(uint64_t);
			}

			PermuteR24P8x1600H(State);
			InputLength -= rate;
		}

		i = 0;

		while (InputLength >= sizeof(uint64_t))
		{
			t = _mm512_i64gather_epi64(idx, (int64_t*)pos, 1);
			State[i] = _mm512_xor_si512(State[i], t);

			i++;
			pos += sizeof(uint64_t);
			InputLength -= sizeof(uint64_t);
		}

		if (InputLength != 0)
		{
			t = _mm512_i64gather_epi64(idx, (int64_t*)pos, 1);
			idx = _mm512_set1_epi64((1ULL << (sizeof(uint64_t) * InputLength)) - 1);
			t = _mm512_and_si512(t, idx);
			State[i] = _mm512_xor_si512(State[i], t);
		}

		t = _mm512_set1_epi64((int64_t)Domain << (sizeof(uint64_t) * InputLength));
		State[i] = _mm512_xor_si512(State[i], t);
		t = _mm512_set1_epi64(1ULL << 63);
		State[(rate / sizeof(uint64_t)) - 1] = _mm512_xor_si512(State[(rate / sizeof(uint64_t)) - 1], t);
	}

	template<typename ArrayU512>
	static void SqueezeBlocksR28x1600H(ArrayU512 &State,
		size_t Rate,
		std::vector<uint8_t> &Output0,
		std::vector<uint8_t> &Output1,
		std::vector<uint8_t> &Output2,
		std::vector<uint8_t> &Output3,
		std::vector<uint8_t> &Output4,
		std::vector<uint8_t> &Output5,
		std::vector<uint8_t> &Output6,
		std::vector<uint8_t> &Output7,
		size_t Blocks)
	{
		__m128i x;
		uint64_t f0;
		uint64_t f1;
		uint64_t f2;
		uint64_t f3;
		uint64_t f4;
		uint64_t f5;
		uint64_t f6;
		uint64_t f7;
		size_t i;
		size_t idx;

		while (Blocks > 0)
		{
			PermuteR24P8x1600H(State);
			idx = 0

			for (i = 0; i < (size_t)rate / sizeof(uint64_t); ++i)
			{
#if defined(CEX_OS_WINDOWS)
				x = _mm512_extracti64x2_epi64(State[i], 0);
				f0 = _mm_extract_epi64(x, 0);
				f0 = (uint64_t)(uint32_t)_mm_extract_epi32(x, 0) | (uint64_t)(uint32_t)_mm_extract_epi32(x, 1) << 32;
				f1 = _mm_extract_epi64(x, 1);
				x = _mm512_extracti64x2_epi64(State[i], 1);
				f2 = _mm_extract_epi64(x, 0);
				f3 = _mm_extract_epi64(x, 1);
				x = _mm512_extracti64x2_epi64(State[i], 2);
				f4 = _mm_extract_epi64(x, 0);
				f5 = _mm_extract_epi64(x, 1);
				x = _mm512_extracti64x2_epi64(State[i], 3);
				f6 = _mm_extract_epi64(x, 0);
				f7 = _mm_extract_epi64(x, 1);
#else
				x = _mm512_extracti64x2_epi64(State[i], 0);
				f0 = (uint64_t)(uint32_t)_mm_extract_epi32(x, 0) | (uint64_t)(uint32_t)_mm_extract_epi32(x, 1) << 32;
				f1 = (uint64_t)(uint32_t)_mm_extract_epi32(x, 2) | (uint64_t)(uint32_t)_mm_extract_epi32(x, 3) << 32;
				x = _mm512_extracti64x2_epi64(State[i], 1);
				f2 = (uint64_t)(uint32_t)_mm_extract_epi32(x, 0) | (uint64_t)(uint32_t)_mm_extract_epi32(x, 1) << 32;
				f3 = (uint64_t)(uint32_t)_mm_extract_epi32(x, 2) | (uint64_t)(uint32_t)_mm_extract_epi32(x, 3) << 32;
				x = _mm512_extracti64x2_epi64(State[i], 2);
				f4 = (uint64_t)(uint32_t)_mm_extract_epi32(x, 0) | (uint64_t)(uint32_t)_mm_extract_epi32(x, 1) << 32;
				f5 = (uint64_t)(uint32_t)_mm_extract_epi32(x, 2) | (uint64_t)(uint32_t)_mm_extract_epi32(x, 3) << 32;
				x = _mm512_extracti64x2_epi64(State[i], 3);
				f6 = (uint64_t)(uint32_t)_mm_extract_epi32(x, 0) | (uint64_t)(uint32_t)_mm_extract_epi32(x, 1) << 32;
				f7 = (uint64_t)(uint32_t)_mm_extract_epi32(x, 2) | (uint64_t)(uint32_t)_mm_extract_epi32(x, 3) << 32;
#endif
				IntegerTools::Le64ToBytes(f0, Output0, idx);
				IntegerTools::Le64ToBytes(f1, Output1, idx);
				IntegerTools::Le64ToBytes(f2, Output2, idx);
				IntegerTools::Le64ToBytes(f3, Output3, idx);
				IntegerTools::Le64ToBytes(f4, Output4, idx);
				IntegerTools::Le64ToBytes(f5, Output5, idx);
				IntegerTools::Le64ToBytes(f6, Output6, idx);
				IntegerTools::Le64ToBytes(f7, Output7, idx);

				idx += sizeof(uint64_t);
			}

			--Blocks;
		}
	}

	/// <summary>
	/// The horizontally vectorized 24 round (standard) form of the SHA3 permutation function.
	/// <para>This function processes 8*25 blocks of state in parallel using AVX512 instructions.</para>
	/// </summary>
	/// 
	/// <param name="State">The permutations ULong512 state array</param>
	/// <param name="Rounds">The number of permutations rounds; defaults at 24</param>
	template<typename ArrayU512>
	static void PermuteR24P8x1600H(ArrayU512 &State, size_t Rounds = 24)
	{
		std::array<ULong512, 25> A;
		std::array<ULong512, 5> C;
		std::array<ULong512, 5> D;
		std::array<ULong512, 25> E;
		size_t i;

		MemoryTools::Copy(State, 0, A, 0, A.size() * sizeof(ULong512));

		for (i = 0; i < Rounds; i += 2)
		{
			// round n
			C[0] = A[0] ^ A[5] ^ A[10] ^ A[15] ^ A[20];
			C[1] = A[1] ^ A[6] ^ A[11] ^ A[16] ^ A[21];
			C[2] = A[2] ^ A[7] ^ A[12] ^ A[17] ^ A[22];
			C[3] = A[3] ^ A[8] ^ A[13] ^ A[18] ^ A[23];
			C[4] = A[4] ^ A[9] ^ A[14] ^ A[19] ^ A[24];
			D[0] = C[4] ^ ULong512::RotL64(C[1], 1);
			D[1] = C[0] ^ ULong512::RotL64(C[2], 1);
			D[2] = C[1] ^ ULong512::RotL64(C[3], 1);
			D[3] = C[2] ^ ULong512::RotL64(C[4], 1);
			D[4] = C[3] ^ ULong512::RotL64(C[0], 1);
			A[0] ^= D[0];
			C[0] = A[0];
			A[6] ^= D[1];
			C[1] = ULong512::RotL64(A[6], 44);
			A[12] ^= D[2];
			C[2] = ULong512::RotL64(A[12], 43);
			A[18] ^= D[3];
			C[3] = ULong512::RotL64(A[18], 21);
			A[24] ^= D[4];
			C[4] = ULong512::RotL64(A[24], 14);
			E[0] = C[0] ^ ((~C[1]) & C[2]);
			E[0] ^= ULong512(KECCAK_RC24[i]);
			E[1] = C[1] ^ ((~C[2]) & C[3]);
			E[2] = C[2] ^ ((~C[3]) & C[4]);
			E[3] = C[3] ^ ((~C[4]) & C[0]);
			E[4] = C[4] ^ ((~C[0]) & C[1]);
			A[3] ^= D[3];
			C[0] = ULong512::RotL64(A[3], 28);
			A[9] ^= D[4];
			C[1] = ULong512::RotL64(A[9], 20);
			A[10] ^= D[0];
			C[2] = ULong512::RotL64(A[10], 3);
			A[16] ^= D[1];
			C[3] = ULong512::RotL64(A[16], 45);
			A[22] ^= D[2];
			C[4] = ULong512::RotL64(A[22], 61);
			E[5] = C[0] ^ ((~C[1]) & C[2]);
			E[6] = C[1] ^ ((~C[2]) & C[3]);
			E[7] = C[2] ^ ((~C[3]) & C[4]);
			E[8] = C[3] ^ ((~C[4]) & C[0]);
			E[9] = C[4] ^ ((~C[0]) & C[1]);
			A[1] ^= D[1];
			C[0] = ULong512::RotL64(A[1], 1);
			A[7] ^= D[2];
			C[1] = ULong512::RotL64(A[7], 6);
			A[13] ^= D[3];
			C[2] = ULong512::RotL64(A[13], 25);
			A[19] ^= D[4];
			C[3] = ULong512::RotL64(A[19], 8);
			A[20] ^= D[0];
			C[4] = ULong512::RotL64(A[20], 18);
			E[10] = C[0] ^ ((~C[1]) & C[2]);
			E[11] = C[1] ^ ((~C[2]) & C[3]);
			E[12] = C[2] ^ ((~C[3]) & C[4]);
			E[13] = C[3] ^ ((~C[4]) & C[0]);
			E[14] = C[4] ^ ((~C[0]) & C[1]);
			A[4] ^= D[4];
			C[0] = ULong512::RotL64(A[4], 27);
			A[5] ^= D[0];
			C[1] = ULong512::RotL64(A[5], 36);
			A[11] ^= D[1];
			C[2] = ULong512::RotL64(A[11], 10);
			A[17] ^= D[2];
			C[3] = ULong512::RotL64(A[17], 15);
			A[23] ^= D[3];
			C[4] = ULong512::RotL64(A[23], 56);
			E[15] = C[0] ^ ((~C[1]) & C[2]);
			E[16] = C[1] ^ ((~C[2]) & C[3]);
			E[17] = C[2] ^ ((~C[3]) & C[4]);
			E[18] = C[3] ^ ((~C[4]) & C[0]);
			E[19] = C[4] ^ ((~C[0]) & C[1]);
			A[2] ^= D[2];
			C[0] = ULong512::RotL64(A[2], 62);
			A[8] ^= D[3];
			C[1] = ULong512::RotL64(A[8], 55);
			A[14] ^= D[4];
			C[2] = ULong512::RotL64(A[14], 39);
			A[15] ^= D[0];
			C[3] = ULong512::RotL64(A[15], 41);
			A[21] ^= D[1];
			C[4] = ULong512::RotL64(A[21], 2);
			E[20] = C[0] ^ ((~C[1]) & C[2]);
			E[21] = C[1] ^ ((~C[2]) & C[3]);
			E[22] = C[2] ^ ((~C[3]) & C[4]);
			E[23] = C[3] ^ ((~C[4]) & C[0]);
			E[24] = C[4] ^ ((~C[0]) & C[1]);
			// round n + 1
			C[0] = E[0] ^ E[5] ^ E[10] ^ E[15] ^ E[20];
			C[1] = E[1] ^ E[6] ^ E[11] ^ E[16] ^ E[21];
			C[2] = E[2] ^ E[7] ^ E[12] ^ E[17] ^ E[22];
			C[3] = E[3] ^ E[8] ^ E[13] ^ E[18] ^ E[23];
			C[4] = E[4] ^ E[9] ^ E[14] ^ E[19] ^ E[24];
			D[0] = C[4] ^ ULong512::RotL64(C[1], 1);
			D[1] = C[0] ^ ULong512::RotL64(C[2], 1);
			D[2] = C[1] ^ ULong512::RotL64(C[3], 1);
			D[3] = C[2] ^ ULong512::RotL64(C[4], 1);
			D[4] = C[3] ^ ULong512::RotL64(C[0], 1);
			E[0] ^= D[0];
			C[0] = E[0];
			E[6] ^= D[1];
			C[1] = ULong512::RotL64(E[6], 44);
			E[12] ^= D[2];
			C[2] = ULong512::RotL64(E[12], 43);
			E[18] ^= D[3];
			C[3] = ULong512::RotL64(E[18], 21);
			E[24] ^= D[4];
			C[4] = ULong512::RotL64(E[24], 14);
			A[0] = C[0] ^ ((~C[1]) & C[2]);
			A[0] ^= ULong512(KECCAK_RC24[i + 1]);
			A[1] = C[1] ^ ((~C[2]) & C[3]);
			A[2] = C[2] ^ ((~C[3]) & C[4]);
			A[3] = C[3] ^ ((~C[4]) & C[0]);
			A[4] = C[4] ^ ((~C[0]) & C[1]);
			E[3] ^= D[3];
			C[0] = ULong512::RotL64(E[3], 28);
			E[9] ^= D[4];
			C[1] = ULong512::RotL64(E[9], 20);
			E[10] ^= D[0];
			C[2] = ULong512::RotL64(E[10], 3);
			E[16] ^= D[1];
			C[3] = ULong512::RotL64(E[16], 45);
			E[22] ^= D[2];
			C[4] = ULong512::RotL64(E[22], 61);
			A[5] = C[0] ^ ((~C[1]) & C[2]);
			A[6] = C[1] ^ ((~C[2]) & C[3]);
			A[7] = C[2] ^ ((~C[3]) & C[4]);
			A[8] = C[3] ^ ((~C[4]) & C[0]);
			A[9] = C[4] ^ ((~C[0]) & C[1]);
			E[1] ^= D[1];
			C[0] = ULong512::RotL64(E[1], 1);
			E[7] ^= D[2];
			C[1] = ULong512::RotL64(E[7], 6);
			E[13] ^= D[3];
			C[2] = ULong512::RotL64(E[13], 25);
			E[19] ^= D[4];
			C[3] = ULong512::RotL64(E[19], 8);
			E[20] ^= D[0];
			C[4] = ULong512::RotL64(E[20], 18);
			A[10] = C[0] ^ ((~C[1]) & C[2]);
			A[11] = C[1] ^ ((~C[2]) & C[3]);
			A[12] = C[2] ^ ((~C[3]) & C[4]);
			A[13] = C[3] ^ ((~C[4]) & C[0]);
			A[14] = C[4] ^ ((~C[0]) & C[1]);
			E[4] ^= D[4];
			C[0] = ULong512::RotL64(E[4], 27);
			E[5] ^= D[0];
			C[1] = ULong512::RotL64(E[5], 36);
			E[11] ^= D[1];
			C[2] = ULong512::RotL64(E[11], 10);
			E[17] ^= D[2];
			C[3] = ULong512::RotL64(E[17], 15);
			E[23] ^= D[3];
			C[4] = ULong512::RotL64(E[23], 56);
			A[15] = C[0] ^ ((~C[1]) & C[2]);
			A[16] = C[1] ^ ((~C[2]) & C[3]);
			A[17] = C[2] ^ ((~C[3]) & C[4]);
			A[18] = C[3] ^ ((~C[4]) & C[0]);
			A[19] = C[4] ^ ((~C[0]) & C[1]);
			E[2] ^= D[2];
			C[0] = ULong512::RotL64(E[2], 62);
			E[8] ^= D[3];
			C[1] = ULong512::RotL64(E[8], 55);
			E[14] ^= D[4];
			C[2] = ULong512::RotL64(E[14], 39);
			E[15] ^= D[0];
			C[3] = ULong512::RotL64(E[15], 41);
			E[21] ^= D[1];
			C[4] = ULong512::RotL64(E[21], 2);
			A[20] = C[0] ^ ((~C[1]) & C[2]);
			A[21] = C[1] ^ ((~C[2]) & C[3]);
			A[22] = C[2] ^ ((~C[3]) & C[4]);
			A[23] = C[3] ^ ((~C[4]) & C[0]);
			A[24] = C[4] ^ ((~C[0]) & C[1]);
		}

		MemoryTools::Copy(A, 0, State, 0, A.size() * sizeof(ULong512));
	}

	/// <summary>
	/// The horizontally vectorized 48 round (extended) form of the SHA3 permutation function.
	/// <para>This function processes 8*25 blocks of state in parallel using AVX512 instructions.</para>
	/// </summary>
	/// 
	/// <param name="State">The permutations ULong512 state array</param>
	template<typename ArrayU512>
	static void PermuteR48P8x1600H(ArrayU512 &State)
	{
		std::array<ULong512, 25> A;
		std::array<ULong512, 5> C;
		std::array<ULong512, 5> D;
		std::array<ULong512, 25> E;
		size_t i;

		MemoryTools::Copy(State, 0, A, 0, A.size() * sizeof(ULong512));

		for (i = 0; i < 48; i += 2)
		{
			// round n
			C[0] = A[0] ^ A[5] ^ A[10] ^ A[15] ^ A[20];
			C[1] = A[1] ^ A[6] ^ A[11] ^ A[16] ^ A[21];
			C[2] = A[2] ^ A[7] ^ A[12] ^ A[17] ^ A[22];
			C[3] = A[3] ^ A[8] ^ A[13] ^ A[18] ^ A[23];
			C[4] = A[4] ^ A[9] ^ A[14] ^ A[19] ^ A[24];
			D[0] = C[4] ^ ULong512::RotL64(C[1], 1);
			D[1] = C[0] ^ ULong512::RotL64(C[2], 1);
			D[2] = C[1] ^ ULong512::RotL64(C[3], 1);
			D[3] = C[2] ^ ULong512::RotL64(C[4], 1);
			D[4] = C[3] ^ ULong512::RotL64(C[0], 1);
			A[0] ^= D[0];
			C[0] = A[0];
			A[6] ^= D[1];
			C[1] = ULong512::RotL64(A[6], 44);
			A[12] ^= D[2];
			C[2] = ULong512::RotL64(A[12], 43);
			A[18] ^= D[3];
			C[3] = ULong512::RotL64(A[18], 21);
			A[24] ^= D[4];
			C[4] = ULong512::RotL64(A[24], 14);
			E[0] = C[0] ^ ((~C[1]) & C[2]);
			E[0] ^= ULong512(KECCAK_RC48[i]);
			E[1] = C[1] ^ ((~C[2]) & C[3]);
			E[2] = C[2] ^ ((~C[3]) & C[4]);
			E[3] = C[3] ^ ((~C[4]) & C[0]);
			E[4] = C[4] ^ ((~C[0]) & C[1]);
			A[3] ^= D[3];
			C[0] = ULong512::RotL64(A[3], 28);
			A[9] ^= D[4];
			C[1] = ULong512::RotL64(A[9], 20);
			A[10] ^= D[0];
			C[2] = ULong512::RotL64(A[10], 3);
			A[16] ^= D[1];
			C[3] = ULong512::RotL64(A[16], 45);
			A[22] ^= D[2];
			C[4] = ULong512::RotL64(A[22], 61);
			E[5] = C[0] ^ ((~C[1]) & C[2]);
			E[6] = C[1] ^ ((~C[2]) & C[3]);
			E[7] = C[2] ^ ((~C[3]) & C[4]);
			E[8] = C[3] ^ ((~C[4]) & C[0]);
			E[9] = C[4] ^ ((~C[0]) & C[1]);
			A[1] ^= D[1];
			C[0] = ULong512::RotL64(A[1], 1);
			A[7] ^= D[2];
			C[1] = ULong512::RotL64(A[7], 6);
			A[13] ^= D[3];
			C[2] = ULong512::RotL64(A[13], 25);
			A[19] ^= D[4];
			C[3] = ULong512::RotL64(A[19], 8);
			A[20] ^= D[0];
			C[4] = ULong512::RotL64(A[20], 18);
			E[10] = C[0] ^ ((~C[1]) & C[2]);
			E[11] = C[1] ^ ((~C[2]) & C[3]);
			E[12] = C[2] ^ ((~C[3]) & C[4]);
			E[13] = C[3] ^ ((~C[4]) & C[0]);
			E[14] = C[4] ^ ((~C[0]) & C[1]);
			A[4] ^= D[4];
			C[0] = ULong512::RotL64(A[4], 27);
			A[5] ^= D[0];
			C[1] = ULong512::RotL64(A[5], 36);
			A[11] ^= D[1];
			C[2] = ULong512::RotL64(A[11], 10);
			A[17] ^= D[2];
			C[3] = ULong512::RotL64(A[17], 15);
			A[23] ^= D[3];
			C[4] = ULong512::RotL64(A[23], 56);
			E[15] = C[0] ^ ((~C[1]) & C[2]);
			E[16] = C[1] ^ ((~C[2]) & C[3]);
			E[17] = C[2] ^ ((~C[3]) & C[4]);
			E[18] = C[3] ^ ((~C[4]) & C[0]);
			E[19] = C[4] ^ ((~C[0]) & C[1]);
			A[2] ^= D[2];
			C[0] = ULong512::RotL64(A[2], 62);
			A[8] ^= D[3];
			C[1] = ULong512::RotL64(A[8], 55);
			A[14] ^= D[4];
			C[2] = ULong512::RotL64(A[14], 39);
			A[15] ^= D[0];
			C[3] = ULong512::RotL64(A[15], 41);
			A[21] ^= D[1];
			C[4] = ULong512::RotL64(A[21], 2);
			E[20] = C[0] ^ ((~C[1]) & C[2]);
			E[21] = C[1] ^ ((~C[2]) & C[3]);
			E[22] = C[2] ^ ((~C[3]) & C[4]);
			E[23] = C[3] ^ ((~C[4]) & C[0]);
			E[24] = C[4] ^ ((~C[0]) & C[1]);
			// round n + 1
			C[0] = E[0] ^ E[5] ^ E[10] ^ E[15] ^ E[20];
			C[1] = E[1] ^ E[6] ^ E[11] ^ E[16] ^ E[21];
			C[2] = E[2] ^ E[7] ^ E[12] ^ E[17] ^ E[22];
			C[3] = E[3] ^ E[8] ^ E[13] ^ E[18] ^ E[23];
			C[4] = E[4] ^ E[9] ^ E[14] ^ E[19] ^ E[24];
			D[0] = C[4] ^ ULong512::RotL64(C[1], 1);
			D[1] = C[0] ^ ULong512::RotL64(C[2], 1);
			D[2] = C[1] ^ ULong512::RotL64(C[3], 1);
			D[3] = C[2] ^ ULong512::RotL64(C[4], 1);
			D[4] = C[3] ^ ULong512::RotL64(C[0], 1);
			E[0] ^= D[0];
			C[0] = E[0];
			E[6] ^= D[1];
			C[1] = ULong512::RotL64(E[6], 44);
			E[12] ^= D[2];
			C[2] = ULong512::RotL64(E[12], 43);
			E[18] ^= D[3];
			C[3] = ULong512::RotL64(E[18], 21);
			E[24] ^= D[4];
			C[4] = ULong512::RotL64(E[24], 14);
			A[0] = C[0] ^ ((~C[1]) & C[2]);
			A[0] ^= ULong512(KECCAK_RC48[i + 1]);
			A[1] = C[1] ^ ((~C[2]) & C[3]);
			A[2] = C[2] ^ ((~C[3]) & C[4]);
			A[3] = C[3] ^ ((~C[4]) & C[0]);
			A[4] = C[4] ^ ((~C[0]) & C[1]);
			E[3] ^= D[3];
			C[0] = ULong512::RotL64(E[3], 28);
			E[9] ^= D[4];
			C[1] = ULong512::RotL64(E[9], 20);
			E[10] ^= D[0];
			C[2] = ULong512::RotL64(E[10], 3);
			E[16] ^= D[1];
			C[3] = ULong512::RotL64(E[16], 45);
			E[22] ^= D[2];
			C[4] = ULong512::RotL64(E[22], 61);
			A[5] = C[0] ^ ((~C[1]) & C[2]);
			A[6] = C[1] ^ ((~C[2]) & C[3]);
			A[7] = C[2] ^ ((~C[3]) & C[4]);
			A[8] = C[3] ^ ((~C[4]) & C[0]);
			A[9] = C[4] ^ ((~C[0]) & C[1]);
			E[1] ^= D[1];
			C[0] = ULong512::RotL64(E[1], 1);
			E[7] ^= D[2];
			C[1] = ULong512::RotL64(E[7], 6);
			E[13] ^= D[3];
			C[2] = ULong512::RotL64(E[13], 25);
			E[19] ^= D[4];
			C[3] = ULong512::RotL64(E[19], 8);
			E[20] ^= D[0];
			C[4] = ULong512::RotL64(E[20], 18);
			A[10] = C[0] ^ ((~C[1]) & C[2]);
			A[11] = C[1] ^ ((~C[2]) & C[3]);
			A[12] = C[2] ^ ((~C[3]) & C[4]);
			A[13] = C[3] ^ ((~C[4]) & C[0]);
			A[14] = C[4] ^ ((~C[0]) & C[1]);
			E[4] ^= D[4];
			C[0] = ULong512::RotL64(E[4], 27);
			E[5] ^= D[0];
			C[1] = ULong512::RotL64(E[5], 36);
			E[11] ^= D[1];
			C[2] = ULong512::RotL64(E[11], 10);
			E[17] ^= D[2];
			C[3] = ULong512::RotL64(E[17], 15);
			E[23] ^= D[3];
			C[4] = ULong512::RotL64(E[23], 56);
			A[15] = C[0] ^ ((~C[1]) & C[2]);
			A[16] = C[1] ^ ((~C[2]) & C[3]);
			A[17] = C[2] ^ ((~C[3]) & C[4]);
			A[18] = C[3] ^ ((~C[4]) & C[0]);
			A[19] = C[4] ^ ((~C[0]) & C[1]);
			E[2] ^= D[2];
			C[0] = ULong512::RotL64(E[2], 62);
			E[8] ^= D[3];
			C[1] = ULong512::RotL64(E[8], 55);
			E[14] ^= D[4];
			C[2] = ULong512::RotL64(E[14], 39);
			E[15] ^= D[0];
			C[3] = ULong512::RotL64(E[15], 41);
			E[21] ^= D[1];
			C[4] = ULong512::RotL64(E[21], 2);
			A[20] = C[0] ^ ((~C[1]) & C[2]);
			A[21] = C[1] ^ ((~C[2]) & C[3]);
			A[22] = C[2] ^ ((~C[3]) & C[4]);
			A[23] = C[3] ^ ((~C[4]) & C[0]);
			A[24] = C[4] ^ ((~C[0]) & C[1]);
		}

		MemoryTools::Copy(A, 0, State, 0, A.size() * sizeof(ULong512));
	}

#elif defined(CEX_HAS_AVX2)

	template<typename ArrayU256>
	static void AbsorbR24x1600H(ArrayU256 &State,
		size_t Rate,
		const std::vector<uint8_t> &Input0, 
		const std::vector<uint8_t> &Input1, 
		const std::vector<uint8_t> &Input2, 
		const std::vector<uint8_t> &Input3, 
		size_t InputLength, 
		uint8_t Domain)
	{
		CEX_ALIGN(32) __m256i t;
		CEX_ALIGN(32) __m256i idx = { 0 };
		int64_t p0;
		int64_t p1;
		int64_t p2;
		int64_t p3;
		int64_t pos;
		size_t i;

		pos = 0;
		p0 = (int64_t)Input0.data();
		p1 = (int64_t)Input1.data();
		p2 = (int64_t)Input2.data();
		p3 = (int64_t)Input3.data();

		idx = _mm256_set_epi64x(p3, p2, p1, p0);

		while (InputLength >= Rate)
		{
			for (i = 0; i < Rate / sizeof(uint64_t); ++i)
			{
				t = _mm256_i64gather_epi64((int64_t*)pos, idx, 1);
				State[i] = _mm256_xor_si256(State[i], t);
				pos += sizeof(uint64_t);
			}

			PermuteR24P4x1600H(State);
			InputLength -= Rate;
		}

		i = 0;

		while (InputLength >= sizeof(uint64_t))
		{
			t = _mm256_i64gather_epi64((int64_t*)pos, idx, 1);
			State[i] = _mm256_xor_si256(State[i], t);

			i++;
			pos += sizeof(uint64_t);
			InputLength -= sizeof(uint64_t);
		}

		if (InputLength != 0)
		{
			t = _mm256_i64gather_epi64((int64_t*)pos, idx, 1);
			idx = _mm256_set1_epi64x((1ULL << (sizeof(uint64_t) * InputLength)) - 1);
			t = _mm256_and_si256(t, idx);
			State[i] = _mm256_xor_si256(State[i], t);
		}

		t = _mm256_set1_epi64x((int64_t)Domain << (sizeof(uint64_t) * InputLength));
		State[i] = _mm256_xor_si256(State[i], t);
		t = _mm256_set1_epi64x(1ULL << 63);
		State[(Rate / sizeof(uint64_t)) - 1] = _mm256_xor_si256(State[(Rate / sizeof(uint64_t)) - 1], t);
	}

	template<typename ArrayU256>
	static void SqueezeBlocksR24x1600H(ArrayU256 &State,
		size_t Rate, 
		std::vector<uint8_t> &Output0, 
		std::vector<uint8_t> &Output1, 
		std::vector<uint8_t> &Output2, 
		std::vector<uint8_t> &Output3, 
		size_t Blocks)
	{
		uint64_t f0;
		uint64_t f1;
		uint64_t f2;
		uint64_t f3;
		size_t idx;

		idx = 0;

		while (Blocks > 0)
		{
			PermuteR24P4x1600H(State);

			for (size_t i = 0; i < (size_t)Rate / sizeof(uint64_t); ++i)
			{
	#if defined(CEX_OS_WINDOWS)
				f0 = _mm256_extract_epi64(State[i], 0);
				f1 = _mm256_extract_epi64(State[i], 1);
				f2 = _mm256_extract_epi64(State[i], 2);
				f3 = _mm256_extract_epi64(State[i], 3);
	#else
				f0 = (uint64_t)(uint32_t)_mm256_extract_epi32(State[i], 0) | ((uint64_t)(uint32_t)_mm256_extract_epi32(State[i], 1) << 32);
				f1 = (uint64_t)(uint32_t)_mm256_extract_epi32(State[i], 2) | ((uint64_t)(uint32_t)_mm256_extract_epi32(State[i], 3) << 32);
				f2 = (uint64_t)(uint32_t)_mm256_extract_epi32(State[i], 4) | ((uint64_t)(uint32_t)_mm256_extract_epi32(State[i], 5) << 32);
				f3 = (uint64_t)(uint32_t)_mm256_extract_epi32(State[i], 6) | ((uint64_t)(uint32_t)_mm256_extract_epi32(State[i], 7) << 32);
	#endif
				IntegerTools::Le64ToBytes(f0, Output0, idx);
				IntegerTools::Le64ToBytes(f1, Output1, idx);
				IntegerTools::Le64ToBytes(f2, Output2, idx);
				IntegerTools::Le64ToBytes(f3, Output3, idx);

				idx += sizeof(uint64_t);
			}

			--Blocks;
		}
	}

	/// <summary>
	/// The horizontally vectorized 24 round (standard) form of the SHA3 permutation function.
	/// <para>This function processes 4*25 blocks of state in parallel using AVX2 instructions.</para>
	/// </summary>
	/// 
	/// <param name="State">The permutations ULong256 state array</param>
	/// <param name="Rounds">The number of permutations rounds; defaults at 24</param>
	template<typename ArrayU256>
	static void PermuteR24P4x1600H(ArrayU256 &State, size_t Rounds = 24)
	{
		std::array<ULong256, 25> A;
		std::array<ULong256, 5> C;
		std::array<ULong256, 5> D;
		std::array<ULong256, 25> E;
		size_t i;

		MemoryTools::Copy(State, 0, A, 0, A.size() * sizeof(ULong256));

		for (i = 0; i < Rounds; i += 2)
		{
			// round n
			C[0] = A[0] ^ A[5] ^ A[10] ^ A[15] ^ A[20];
			C[1] = A[1] ^ A[6] ^ A[11] ^ A[16] ^ A[21];
			C[2] = A[2] ^ A[7] ^ A[12] ^ A[17] ^ A[22];
			C[3] = A[3] ^ A[8] ^ A[13] ^ A[18] ^ A[23];
			C[4] = A[4] ^ A[9] ^ A[14] ^ A[19] ^ A[24];
			D[0] = C[4] ^ ULong256::RotL64(C[1], 1);
			D[1] = C[0] ^ ULong256::RotL64(C[2], 1);
			D[2] = C[1] ^ ULong256::RotL64(C[3], 1);
			D[3] = C[2] ^ ULong256::RotL64(C[4], 1);
			D[4] = C[3] ^ ULong256::RotL64(C[0], 1);
			A[0] ^= D[0];
			C[0] = A[0];
			A[6] ^= D[1];
			C[1] = ULong256::RotL64(A[6], 44);
			A[12] ^= D[2];
			C[2] = ULong256::RotL64(A[12], 43);
			A[18] ^= D[3];
			C[3] = ULong256::RotL64(A[18], 21);
			A[24] ^= D[4];
			C[4] = ULong256::RotL64(A[24], 14);
			E[0] = C[0] ^ ((~C[1]) & C[2]);
			E[0] ^= ULong256(KECCAK_RC24[i]);
			E[1] = C[1] ^ ((~C[2]) & C[3]);
			E[2] = C[2] ^ ((~C[3]) & C[4]);
			E[3] = C[3] ^ ((~C[4]) & C[0]);
			E[4] = C[4] ^ ((~C[0]) & C[1]);
			A[3] ^= D[3];
			C[0] = ULong256::RotL64(A[3], 28);
			A[9] ^= D[4];
			C[1] = ULong256::RotL64(A[9], 20);
			A[10] ^= D[0];
			C[2] = ULong256::RotL64(A[10], 3);
			A[16] ^= D[1];
			C[3] = ULong256::RotL64(A[16], 45);
			A[22] ^= D[2];
			C[4] = ULong256::RotL64(A[22], 61);
			E[5] = C[0] ^ ((~C[1]) & C[2]);
			E[6] = C[1] ^ ((~C[2]) & C[3]);
			E[7] = C[2] ^ ((~C[3]) & C[4]);
			E[8] = C[3] ^ ((~C[4]) & C[0]);
			E[9] = C[4] ^ ((~C[0]) & C[1]);
			A[1] ^= D[1];
			C[0] = ULong256::RotL64(A[1], 1);
			A[7] ^= D[2];
			C[1] = ULong256::RotL64(A[7], 6);
			A[13] ^= D[3];
			C[2] = ULong256::RotL64(A[13], 25);
			A[19] ^= D[4];
			C[3] = ULong256::RotL64(A[19], 8);
			A[20] ^= D[0];
			C[4] = ULong256::RotL64(A[20], 18);
			E[10] = C[0] ^ ((~C[1]) & C[2]);
			E[11] = C[1] ^ ((~C[2]) & C[3]);
			E[12] = C[2] ^ ((~C[3]) & C[4]);
			E[13] = C[3] ^ ((~C[4]) & C[0]);
			E[14] = C[4] ^ ((~C[0]) & C[1]);
			A[4] ^= D[4];
			C[0] = ULong256::RotL64(A[4], 27);
			A[5] ^= D[0];
			C[1] = ULong256::RotL64(A[5], 36);
			A[11] ^= D[1];
			C[2] = ULong256::RotL64(A[11], 10);
			A[17] ^= D[2];
			C[3] = ULong256::RotL64(A[17], 15);
			A[23] ^= D[3];
			C[4] = ULong256::RotL64(A[23], 56);
			E[15] = C[0] ^ ((~C[1]) & C[2]);
			E[16] = C[1] ^ ((~C[2]) & C[3]);
			E[17] = C[2] ^ ((~C[3]) & C[4]);
			E[18] = C[3] ^ ((~C[4]) & C[0]);
			E[19] = C[4] ^ ((~C[0]) & C[1]);
			A[2] ^= D[2];
			C[0] = ULong256::RotL64(A[2], 62);
			A[8] ^= D[3];
			C[1] = ULong256::RotL64(A[8], 55);
			A[14] ^= D[4];
			C[2] = ULong256::RotL64(A[14], 39);
			A[15] ^= D[0];
			C[3] = ULong256::RotL64(A[15], 41);
			A[21] ^= D[1];
			C[4] = ULong256::RotL64(A[21], 2);
			E[20] = C[0] ^ ((~C[1]) & C[2]);
			E[21] = C[1] ^ ((~C[2]) & C[3]);
			E[22] = C[2] ^ ((~C[3]) & C[4]);
			E[23] = C[3] ^ ((~C[4]) & C[0]);
			E[24] = C[4] ^ ((~C[0]) & C[1]);
			// round n + 1
			C[0] = E[0] ^ E[5] ^ E[10] ^ E[15] ^ E[20];
			C[1] = E[1] ^ E[6] ^ E[11] ^ E[16] ^ E[21];
			C[2] = E[2] ^ E[7] ^ E[12] ^ E[17] ^ E[22];
			C[3] = E[3] ^ E[8] ^ E[13] ^ E[18] ^ E[23];
			C[4] = E[4] ^ E[9] ^ E[14] ^ E[19] ^ E[24];
			D[0] = C[4] ^ ULong256::RotL64(C[1], 1);
			D[1] = C[0] ^ ULong256::RotL64(C[2], 1);
			D[2] = C[1] ^ ULong256::RotL64(C[3], 1);
			D[3] = C[2] ^ ULong256::RotL64(C[4], 1);
			D[4] = C[3] ^ ULong256::RotL64(C[0], 1);
			E[0] ^= D[0];
			C[0] = E[0];
			E[6] ^= D[1];
			C[1] = ULong256::RotL64(E[6], 44);
			E[12] ^= D[2];
			C[2] = ULong256::RotL64(E[12], 43);
			E[18] ^= D[3];
			C[3] = ULong256::RotL64(E[18], 21);
			E[24] ^= D[4];
			C[4] = ULong256::RotL64(E[24], 14);
			A[0] = C[0] ^ ((~C[1]) & C[2]);
			A[0] ^= ULong256(KECCAK_RC24[i + 1]);
			A[1] = C[1] ^ ((~C[2]) & C[3]);
			A[2] = C[2] ^ ((~C[3]) & C[4]);
			A[3] = C[3] ^ ((~C[4]) & C[0]);
			A[4] = C[4] ^ ((~C[0]) & C[1]);
			E[3] ^= D[3];
			C[0] = ULong256::RotL64(E[3], 28);
			E[9] ^= D[4];
			C[1] = ULong256::RotL64(E[9], 20);
			E[10] ^= D[0];
			C[2] = ULong256::RotL64(E[10], 3);
			E[16] ^= D[1];
			C[3] = ULong256::RotL64(E[16], 45);
			E[22] ^= D[2];
			C[4] = ULong256::RotL64(E[22], 61);
			A[5] = C[0] ^ ((~C[1]) & C[2]);
			A[6] = C[1] ^ ((~C[2]) & C[3]);
			A[7] = C[2] ^ ((~C[3]) & C[4]);
			A[8] = C[3] ^ ((~C[4]) & C[0]);
			A[9] = C[4] ^ ((~C[0]) & C[1]);
			E[1] ^= D[1];
			C[0] = ULong256::RotL64(E[1], 1);
			E[7] ^= D[2];
			C[1] = ULong256::RotL64(E[7], 6);
			E[13] ^= D[3];
			C[2] = ULong256::RotL64(E[13], 25);
			E[19] ^= D[4];
			C[3] = ULong256::RotL64(E[19], 8);
			E[20] ^= D[0];
			C[4] = ULong256::RotL64(E[20], 18);
			A[10] = C[0] ^ ((~C[1]) & C[2]);
			A[11] = C[1] ^ ((~C[2]) & C[3]);
			A[12] = C[2] ^ ((~C[3]) & C[4]);
			A[13] = C[3] ^ ((~C[4]) & C[0]);
			A[14] = C[4] ^ ((~C[0]) & C[1]);
			E[4] ^= D[4];
			C[0] = ULong256::RotL64(E[4], 27);
			E[5] ^= D[0];
			C[1] = ULong256::RotL64(E[5], 36);
			E[11] ^= D[1];
			C[2] = ULong256::RotL64(E[11], 10);
			E[17] ^= D[2];
			C[3] = ULong256::RotL64(E[17], 15);
			E[23] ^= D[3];
			C[4] = ULong256::RotL64(E[23], 56);
			A[15] = C[0] ^ ((~C[1]) & C[2]);
			A[16] = C[1] ^ ((~C[2]) & C[3]);
			A[17] = C[2] ^ ((~C[3]) & C[4]);
			A[18] = C[3] ^ ((~C[4]) & C[0]);
			A[19] = C[4] ^ ((~C[0]) & C[1]);
			E[2] ^= D[2];
			C[0] = ULong256::RotL64(E[2], 62);
			E[8] ^= D[3];
			C[1] = ULong256::RotL64(E[8], 55);
			E[14] ^= D[4];
			C[2] = ULong256::RotL64(E[14], 39);
			E[15] ^= D[0];
			C[3] = ULong256::RotL64(E[15], 41);
			E[21] ^= D[1];
			C[4] = ULong256::RotL64(E[21], 2);
			A[20] = C[0] ^ ((~C[1]) & C[2]);
			A[21] = C[1] ^ ((~C[2]) & C[3]);
			A[22] = C[2] ^ ((~C[3]) & C[4]);
			A[23] = C[3] ^ ((~C[4]) & C[0]);
			A[24] = C[4] ^ ((~C[0]) & C[1]);
		}

		MemoryTools::Copy(A, 0, State, 0, A.size() * sizeof(ULong256));
	}

	/// <summary>
	/// The horizontally vectorized 48 round form (extended) of the SHA3 permutation function.
	/// <para>This function processes 4*25 blocks of state in parallel using AVX2 instructions.</para>
	/// </summary>
	/// 
	/// <param name="State">The permutations ULong256 state array</param>
	template<typename ArrayU256>
	static void PermuteR48P4x1600H(ArrayU256 &State)
	{
		std::array<ULong256, 25> A;
		std::array<ULong256, 5> C;
		std::array<ULong256, 5> D;
		std::array<ULong256, 25> E;
		size_t i;

		MemoryTools::Copy(State, 0, A, 0, A.size() * sizeof(ULong256));

		for (i = 0; i < 48; i += 2)
		{
			// round n
			C[0] = A[0] ^ A[5] ^ A[10] ^ A[15] ^ A[20];
			C[1] = A[1] ^ A[6] ^ A[11] ^ A[16] ^ A[21];
			C[2] = A[2] ^ A[7] ^ A[12] ^ A[17] ^ A[22];
			C[3] = A[3] ^ A[8] ^ A[13] ^ A[18] ^ A[23];
			C[4] = A[4] ^ A[9] ^ A[14] ^ A[19] ^ A[24];
			D[0] = C[4] ^ ULong256::RotL64(C[1], 1);
			D[1] = C[0] ^ ULong256::RotL64(C[2], 1);
			D[2] = C[1] ^ ULong256::RotL64(C[3], 1);
			D[3] = C[2] ^ ULong256::RotL64(C[4], 1);
			D[4] = C[3] ^ ULong256::RotL64(C[0], 1);
			A[0] ^= D[0];
			C[0] = A[0];
			A[6] ^= D[1];
			C[1] = ULong256::RotL64(A[6], 44);
			A[12] ^= D[2];
			C[2] = ULong256::RotL64(A[12], 43);
			A[18] ^= D[3];
			C[3] = ULong256::RotL64(A[18], 21);
			A[24] ^= D[4];
			C[4] = ULong256::RotL64(A[24], 14);
			E[0] = C[0] ^ ((~C[1]) & C[2]);
			E[0] ^= ULong256(KECCAK_RC48[i]);
			E[1] = C[1] ^ ((~C[2]) & C[3]);
			E[2] = C[2] ^ ((~C[3]) & C[4]);
			E[3] = C[3] ^ ((~C[4]) & C[0]);
			E[4] = C[4] ^ ((~C[0]) & C[1]);
			A[3] ^= D[3];
			C[0] = ULong256::RotL64(A[3], 28);
			A[9] ^= D[4];
			C[1] = ULong256::RotL64(A[9], 20);
			A[10] ^= D[0];
			C[2] = ULong256::RotL64(A[10], 3);
			A[16] ^= D[1];
			C[3] = ULong256::RotL64(A[16], 45);
			A[22] ^= D[2];
			C[4] = ULong256::RotL64(A[22], 61);
			E[5] = C[0] ^ ((~C[1]) & C[2]);
			E[6] = C[1] ^ ((~C[2]) & C[3]);
			E[7] = C[2] ^ ((~C[3]) & C[4]);
			E[8] = C[3] ^ ((~C[4]) & C[0]);
			E[9] = C[4] ^ ((~C[0]) & C[1]);
			A[1] ^= D[1];
			C[0] = ULong256::RotL64(A[1], 1);
			A[7] ^= D[2];
			C[1] = ULong256::RotL64(A[7], 6);
			A[13] ^= D[3];
			C[2] = ULong256::RotL64(A[13], 25);
			A[19] ^= D[4];
			C[3] = ULong256::RotL64(A[19], 8);
			A[20] ^= D[0];
			C[4] = ULong256::RotL64(A[20], 18);
			E[10] = C[0] ^ ((~C[1]) & C[2]);
			E[11] = C[1] ^ ((~C[2]) & C[3]);
			E[12] = C[2] ^ ((~C[3]) & C[4]);
			E[13] = C[3] ^ ((~C[4]) & C[0]);
			E[14] = C[4] ^ ((~C[0]) & C[1]);
			A[4] ^= D[4];
			C[0] = ULong256::RotL64(A[4], 27);
			A[5] ^= D[0];
			C[1] = ULong256::RotL64(A[5], 36);
			A[11] ^= D[1];
			C[2] = ULong256::RotL64(A[11], 10);
			A[17] ^= D[2];
			C[3] = ULong256::RotL64(A[17], 15);
			A[23] ^= D[3];
			C[4] = ULong256::RotL64(A[23], 56);
			E[15] = C[0] ^ ((~C[1]) & C[2]);
			E[16] = C[1] ^ ((~C[2]) & C[3]);
			E[17] = C[2] ^ ((~C[3]) & C[4]);
			E[18] = C[3] ^ ((~C[4]) & C[0]);
			E[19] = C[4] ^ ((~C[0]) & C[1]);
			A[2] ^= D[2];
			C[0] = ULong256::RotL64(A[2], 62);
			A[8] ^= D[3];
			C[1] = ULong256::RotL64(A[8], 55);
			A[14] ^= D[4];
			C[2] = ULong256::RotL64(A[14], 39);
			A[15] ^= D[0];
			C[3] = ULong256::RotL64(A[15], 41);
			A[21] ^= D[1];
			C[4] = ULong256::RotL64(A[21], 2);
			E[20] = C[0] ^ ((~C[1]) & C[2]);
			E[21] = C[1] ^ ((~C[2]) & C[3]);
			E[22] = C[2] ^ ((~C[3]) & C[4]);
			E[23] = C[3] ^ ((~C[4]) & C[0]);
			E[24] = C[4] ^ ((~C[0]) & C[1]);
			// round n + 1
			C[0] = E[0] ^ E[5] ^ E[10] ^ E[15] ^ E[20];
			C[1] = E[1] ^ E[6] ^ E[11] ^ E[16] ^ E[21];
			C[2] = E[2] ^ E[7] ^ E[12] ^ E[17] ^ E[22];
			C[3] = E[3] ^ E[8] ^ E[13] ^ E[18] ^ E[23];
			C[4] = E[4] ^ E[9] ^ E[14] ^ E[19] ^ E[24];
			D[0] = C[4] ^ ULong256::RotL64(C[1], 1);
			D[1] = C[0] ^ ULong256::RotL64(C[2], 1);
			D[2] = C[1] ^ ULong256::RotL64(C[3], 1);
			D[3] = C[2] ^ ULong256::RotL64(C[4], 1);
			D[4] = C[3] ^ ULong256::RotL64(C[0], 1);
			E[0] ^= D[0];
			C[0] = E[0];
			E[6] ^= D[1];
			C[1] = ULong256::RotL64(E[6], 44);
			E[12] ^= D[2];
			C[2] = ULong256::RotL64(E[12], 43);
			E[18] ^= D[3];
			C[3] = ULong256::RotL64(E[18], 21);
			E[24] ^= D[4];
			C[4] = ULong256::RotL64(E[24], 14);
			A[0] = C[0] ^ ((~C[1]) & C[2]);
			A[0] ^= ULong256(KECCAK_RC48[i + 1]);
			A[1] = C[1] ^ ((~C[2]) & C[3]);
			A[2] = C[2] ^ ((~C[3]) & C[4]);
			A[3] = C[3] ^ ((~C[4]) & C[0]);
			A[4] = C[4] ^ ((~C[0]) & C[1]);
			E[3] ^= D[3];
			C[0] = ULong256::RotL64(E[3], 28);
			E[9] ^= D[4];
			C[1] = ULong256::RotL64(E[9], 20);
			E[10] ^= D[0];
			C[2] = ULong256::RotL64(E[10], 3);
			E[16] ^= D[1];
			C[3] = ULong256::RotL64(E[16], 45);
			E[22] ^= D[2];
			C[4] = ULong256::RotL64(E[22], 61);
			A[5] = C[0] ^ ((~C[1]) & C[2]);
			A[6] = C[1] ^ ((~C[2]) & C[3]);
			A[7] = C[2] ^ ((~C[3]) & C[4]);
			A[8] = C[3] ^ ((~C[4]) & C[0]);
			A[9] = C[4] ^ ((~C[0]) & C[1]);
			E[1] ^= D[1];
			C[0] = ULong256::RotL64(E[1], 1);
			E[7] ^= D[2];
			C[1] = ULong256::RotL64(E[7], 6);
			E[13] ^= D[3];
			C[2] = ULong256::RotL64(E[13], 25);
			E[19] ^= D[4];
			C[3] = ULong256::RotL64(E[19], 8);
			E[20] ^= D[0];
			C[4] = ULong256::RotL64(E[20], 18);
			A[10] = C[0] ^ ((~C[1]) & C[2]);
			A[11] = C[1] ^ ((~C[2]) & C[3]);
			A[12] = C[2] ^ ((~C[3]) & C[4]);
			A[13] = C[3] ^ ((~C[4]) & C[0]);
			A[14] = C[4] ^ ((~C[0]) & C[1]);
			E[4] ^= D[4];
			C[0] = ULong256::RotL64(E[4], 27);
			E[5] ^= D[0];
			C[1] = ULong256::RotL64(E[5], 36);
			E[11] ^= D[1];
			C[2] = ULong256::RotL64(E[11], 10);
			E[17] ^= D[2];
			C[3] = ULong256::RotL64(E[17], 15);
			E[23] ^= D[3];
			C[4] = ULong256::RotL64(E[23], 56);
			A[15] = C[0] ^ ((~C[1]) & C[2]);
			A[16] = C[1] ^ ((~C[2]) & C[3]);
			A[17] = C[2] ^ ((~C[3]) & C[4]);
			A[18] = C[3] ^ ((~C[4]) & C[0]);
			A[19] = C[4] ^ ((~C[0]) & C[1]);
			E[2] ^= D[2];
			C[0] = ULong256::RotL64(E[2], 62);
			E[8] ^= D[3];
			C[1] = ULong256::RotL64(E[8], 55);
			E[14] ^= D[4];
			C[2] = ULong256::RotL64(E[14], 39);
			E[15] ^= D[0];
			C[3] = ULong256::RotL64(E[15], 41);
			E[21] ^= D[1];
			C[4] = ULong256::RotL64(E[21], 2);
			A[20] = C[0] ^ ((~C[1]) & C[2]);
			A[21] = C[1] ^ ((~C[2]) & C[3]);
			A[22] = C[2] ^ ((~C[3]) & C[4]);
			A[23] = C[3] ^ ((~C[4]) & C[0]);
			A[24] = C[4] ^ ((~C[0]) & C[1]);
		}

		MemoryTools::Copy(A, 0, State, 0, A.size() * sizeof(ULong256));
	}

#endif

	/// <summary>
	/// The Keccak 24-round extraction function; extract blocks of state to an output 8-bit array
	/// </summary>
	/// 
	/// <param name="State">The Keccak uint64 state array</param>
	/// <param name="Output">The output uint8_t array, can be either an 8-bit array or vector</param>
	/// <param name="OutOffset">The starting offset withing the output array</param>
	/// <param name="Blocks">The number of blocks to extract</param>
	/// <param name="Rate">The Keccak extraction rate</param>
	template<typename ArrayU8, typename ArrayU64x25>
	static void Squeeze(ArrayU64x25 &State, ArrayU8 &Output, size_t OutOffset, size_t Blocks, size_t Rate, PermutationRounds Rounds = PermutationRounds::RX24)
	{
		while (Blocks > 0)
		{
			Permute(State, Rounds);

#if defined(CEX_IS_LITTLE_ENDIAN)
			MemoryTools::Copy(State, 0, Output, OutOffset, Rate);
#else

			for (size_t i = 0; i < (Rate >> 3); i++)
			{
				IntegerTools::Le64ToBytes(State[i], Output, OutOffset + (8 * i));
			}
#endif

			OutOffset += Rate;
			--Blocks;
		}
	}
	
	/// <summary>
	/// Squeeze a number of bytes into an output uint8_t vector or array
	/// </summary>
	///
	/// <param name="State">The Keccak uint64 state array</param>
	/// <param name="Output">The output uint8_t array</param>
	/// <param name="OutOffset">The starting offset withing the output array</param>
	/// <param name="OutLength">The number of bytes to generate</param>
	/// <param name="Rate">The Keccak aborbtion rate in bytes</param>
	/// <param name="Rounds">The number of transformation rounds, the default is 24</param>
	template<typename ArrayU8, typename ArrayU64x25>
	static void SqueezePartial(ArrayU64x25 &State, ArrayU8 &Output, size_t OutOffset, size_t OutLength, uint32_t Rate, PermutationRounds Rounds = PermutationRounds::RX24)
	{
		std::vector<uint8_t> buf(Rate);

		Squeeze(State, buf, 0, 1, Rate, Rounds);
		MemoryTools::Copy(buf, 0, Output, OutOffset, OutLength);
	}

	/// <summary>
	/// The Keccak XOF function using 24 rounds; process an input seed array and return a pseudo-random output array.
	/// <para>A compact form of the SHAKE XOF function.</para>
	/// </summary>
	/// 
	/// <param name="Input">The input uint8_t seed array, can be either an 8-bit array or vector</param>
	/// <param name="InOffset">The starting offset withing the input array</param>
	/// <param name="InLength">The number of bytes to process</param>
	/// <param name="Output">The input uint8_t seed array, can be either an 8-bit array or vector</param>
	/// <param name="Rate">The block input rate of permutation calls; SHAKE128=168, SHAKE256=136, SHAKE512=72</param>
	template<typename ArrayU8A, typename ArrayU8B>
	static void XOFP1600(const ArrayU8A &Input, size_t InOffset, size_t InLength, ArrayU8B &Output, size_t OutOffset, size_t OutLength, size_t Rate, PermutationRounds Rounds = PermutationRounds::RX24)
	{
		std::array<uint64_t, KECCAK_STATE_SIZE> state = { 0 };
		std::array<uint8_t, KECCAK_STATE_BYTE_SIZE> msg = { 0 };
		size_t blkcnt;
		size_t i;

		while (InLength >= Rate)
		{
			FastAbsorb(Input, InOffset, Rate, state);
			Permute(state, Rounds);
			InLength -= Rate;
			InOffset += Rate;
		}

		MemoryTools::Copy(Input, InOffset, msg, 0, InLength);
		msg[InLength] = KECCAK_SHAKE_DOMAIN;
		MemoryTools::Clear(msg, InLength + 1, Rate - InLength + 1);
		msg[Rate - 1] |= 128;

#if defined(CEX_IS_LITTLE_ENDIAN)
		MemoryTools::XOR(msg, 0, state, 0, Rate);
#else
		for (i = 0; i < (Rate >> 3); ++i)
		{
			state[i] ^= IntegerTools::LeBytesTo64(msg, (8 * i));
		}
#endif

		blkcnt = OutLength / Rate;
		Squeeze(state, Output, OutOffset, blkcnt, Rate, Rounds);
		OutOffset += blkcnt * Rate;
		OutLength -= blkcnt * Rate;

		if (OutLength != 0)
		{
			Permute(state, Rounds);

			const size_t FNLBLK = (OutLength % sizeof(uint64_t) == 0) ? OutLength / sizeof(uint64_t) : OutLength / sizeof(uint64_t) + 1;

			for (i = 0; i < FNLBLK; i++)
			{
				IntegerTools::Le64ToBytes(state[i], msg, (8 * i));
			}

			MemoryTools::Copy(msg, 0, Output, OutOffset, OutLength);
		}
	}

	/// <summary>
	/// The extended Keccak XOF function using 48 rounds; process an input seed array and return a pseudo-random output array.
	/// <para>A compact form of the SHAKE XOF function.</para>
	/// </summary>
	/// 
	/// <param name="Input">The input uint8_t seed array, can be either an 8-bit array or vector</param>
	/// <param name="InOffset">The starting offset withing the input array</param>
	/// <param name="InLength">The number of seed bytes to process</param>
	/// <param name="Output">The input uint8_t seed array, can be either an 8-bit array or vector</param>
	/// <param name="OutOffset">The starting offset withing the output array</param>
	/// <param name="OutLength">The number of output bytes to produce</param>
	/// <param name="Rate">The block input rate of permutation calls; SHAKE128=168, SHAKE256=136, SHAKE512=72</param>
	template<typename ArrayU8A, typename ArrayU8B>
	static void XOFR48P1600(const ArrayU8A &Input, size_t InOffset, size_t InLength, ArrayU8B &Output, size_t OutOffset, size_t OutLength, size_t Rate)
	{
		std::array<uint8_t, KECCAK_STATE_SIZE * sizeof(uint64_t)> msg = { 0 };
		std::array<uint64_t, KECCAK_STATE_SIZE> state = { 0 };
		size_t blkcnt;
		size_t i;

		while (InLength >= Rate)
		{
			FastAbsorb(Input, InOffset, Rate, state);
			PermuteR48P1600U(state);
			InLength -= Rate;
			InOffset += Rate;
		}

		MemoryTools::Copy(Input, InOffset, msg, 0, InLength);
		msg[InLength] = KECCAK_SHAKE_DOMAIN;
		MemoryTools::Clear(msg, InLength + 1, Rate - InLength + 1);
		msg[Rate - 1] |= 128;

#if defined(CEX_IS_LITTLE_ENDIAN)
		MemoryTools::XOR(msg, 0, state, 0, Rate);
#else
		for (i = 0; i < (Rate >> 3); ++i)
		{
			state[i] ^= IntegerTools::LeBytesTo64(msg, (8 * i));
		}
#endif

		blkcnt = OutLength / Rate;
		SqueezeR48(state, Output, OutOffset, blkcnt, Rate);
		OutOffset += blkcnt * Rate;
		OutLength -= blkcnt * Rate;

		if (OutLength != 0)
		{
			PermuteR48P1600U(state);

			const size_t FNLBLK = (OutLength % sizeof(uint64_t) == 0) ? OutLength / sizeof(uint64_t) : OutLength / sizeof(uint64_t) + 1;

			for (i = 0; i < FNLBLK; ++i)
			{
				IntegerTools::Le64ToBytes(state[i], msg, (sizeof(uint64_t) * i));
			}

			MemoryTools::Copy(msg, 0, Output, OutOffset, OutLength);
		}
	}

	/// <summary>
	/// Keccak common function: Right encode a value onto an array
	/// </summary>
	/// 
	/// <param name="Output">The output integer array</param>
	/// <param name="Offset">The output array starting offest</param>
	/// <param name="Value">The value to remove</param>
	/// 
	/// <returns>The number of encoded bits</returns>
	template<typename Array>
	static uint64_t RightEncode(Array &Output, size_t Offset, uint64_t Value)
	{
		uint64_t i;
		uint64_t n;
		uint64_t v;

		for (v = Value, n = 0; (v > 0) && (n < sizeof(uint64_t)); ++n, v >>= 8)
		{
		}

		if (n == 0)
		{
			n = 1;
		}

		for (i = 1; i <= n; ++i)
		{
			Output[Offset + (i - 1)] = static_cast<uint8_t>(Value >> (8 * (n - i)));
		}

		Output[Offset + n] = static_cast<uint8_t>(n);

		return n + 1;
	}
};

NAMESPACE_DIGESTEND
#endif
