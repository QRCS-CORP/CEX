<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CEX++: HKDSServer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CEX++
   &#160;<span id="projectnumber">1.0.0.8f</span>
   </div>
   <div id="projectbrief">The CEX Cryptographic Library in C++</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="class_h_k_d_s_server-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">HKDSServer Class Reference<span class="mlabels"><span class="mlabel">final</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p>Hierarchal Key Distribution System Server (HKDS-SERVER)  
 <a href="class_h_k_d_s_server.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_h_k_d_s_server_8h_source.html">HKDSServer.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a950c4e337bd9046b41ae17d0005f71fb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_h_k_d_s_server.html#a950c4e337bd9046b41ae17d0005f71fb">HKDSServer</a> (<a class="el" href="class_h_k_d_s_master_key.html">HKDSMasterKey</a> &amp;Mdk, const std::vector&lt; byte &gt; &amp;Ksn)</td></tr>
<tr class="memdesc:a950c4e337bd9046b41ae17d0005f71fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">The HKDS server constructor  <a href="class_h_k_d_s_server.html#a950c4e337bd9046b41ae17d0005f71fb">More...</a><br /></td></tr>
<tr class="separator:a950c4e337bd9046b41ae17d0005f71fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae849569e80f7a5b6e6d40b9410990658"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_h_k_d_s_server.html#ae849569e80f7a5b6e6d40b9410990658">~HKDSServer</a> ()</td></tr>
<tr class="memdesc:ae849569e80f7a5b6e6d40b9410990658"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finalize and destroy state  <a href="class_h_k_d_s_server.html#ae849569e80f7a5b6e6d40b9410990658">More...</a><br /></td></tr>
<tr class="separator:ae849569e80f7a5b6e6d40b9410990658"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acab0a5694372b8e724666a8778f988da"><td class="memItemLeft" align="right" valign="top">const size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_h_k_d_s_server.html#acab0a5694372b8e724666a8778f988da">KeyCacheSize</a> ()</td></tr>
<tr class="memdesc:acab0a5694372b8e724666a8778f988da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read Only: The number of keys in a full cache  <a href="class_h_k_d_s_server.html#acab0a5694372b8e724666a8778f988da">More...</a><br /></td></tr>
<tr class="separator:acab0a5694372b8e724666a8778f988da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa39fd72c9529f4706d6c1b763e2c1ce1"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="group___enumeration.html#ga463c29a8bffdd0c01e8579147b26c725">Kms</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_h_k_d_s_server.html#aa39fd72c9529f4706d6c1b763e2c1ce1">Enumeral</a> ()</td></tr>
<tr class="memdesc:aa39fd72c9529f4706d6c1b763e2c1ce1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read Only: The KMS server type name  <a href="class_h_k_d_s_server.html#aa39fd72c9529f4706d6c1b763e2c1ce1">More...</a><br /></td></tr>
<tr class="separator:aa39fd72c9529f4706d6c1b763e2c1ce1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae205d1f4c5eb4e72279c7a0b515af462"><td class="memItemLeft" align="right" valign="top">std::vector&lt; byte &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_h_k_d_s_server.html#ae205d1f4c5eb4e72279c7a0b515af462">KSN</a> ()</td></tr>
<tr class="memdesc:ae205d1f4c5eb4e72279c7a0b515af462"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read/Write: The clients key serial number  <a href="class_h_k_d_s_server.html#ae205d1f4c5eb4e72279c7a0b515af462">More...</a><br /></td></tr>
<tr class="separator:ae205d1f4c5eb4e72279c7a0b515af462"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5180f98c4bdb330ceba5c945e673da90"><td class="memItemLeft" align="right" valign="top">const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_h_k_d_s_server.html#a5180f98c4bdb330ceba5c945e673da90">Name</a> ()</td></tr>
<tr class="memdesc:a5180f98c4bdb330ceba5c945e673da90"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read Only: The KMS formal implementation name  <a href="class_h_k_d_s_server.html#a5180f98c4bdb330ceba5c945e673da90">More...</a><br /></td></tr>
<tr class="separator:a5180f98c4bdb330ceba5c945e673da90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c36fde2cba1a02ffe651562ded1a5f4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_h_k_d_s_server.html#a8c36fde2cba1a02ffe651562ded1a5f4">Decrypt</a> (const std::vector&lt; byte &gt; &amp;Input, std::vector&lt; byte &gt; &amp;Output)</td></tr>
<tr class="memdesc:a8c36fde2cba1a02ffe651562ded1a5f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypt a message from the client  <a href="class_h_k_d_s_server.html#a8c36fde2cba1a02ffe651562ded1a5f4">More...</a><br /></td></tr>
<tr class="separator:a8c36fde2cba1a02ffe651562ded1a5f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7eb8c1a72d4ddce496908dc8959dc040"><td class="memItemLeft" align="right" valign="top">std::vector&lt; byte &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_h_k_d_s_server.html#a7eb8c1a72d4ddce496908dc8959dc040">DecryptVerify</a> (const std::vector&lt; byte &gt; &amp;CipherText, const std::vector&lt; byte &gt; &amp;AdditionalData)</td></tr>
<tr class="memdesc:a7eb8c1a72d4ddce496908dc8959dc040"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verify a ciphertext's integrity with a keyed MAC, if verified return the decrypted PIN message.  <a href="class_h_k_d_s_server.html#a7eb8c1a72d4ddce496908dc8959dc040">More...</a><br /></td></tr>
<tr class="separator:a7eb8c1a72d4ddce496908dc8959dc040"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af54f6964ca8ea6ffa465c27b691593c8"><td class="memItemLeft" align="right" valign="top">std::vector&lt; byte &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_h_k_d_s_server.html#af54f6964ca8ea6ffa465c27b691593c8">EncryptToken</a> ()</td></tr>
<tr class="memdesc:af54f6964ca8ea6ffa465c27b691593c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt the token key  <a href="class_h_k_d_s_server.html#af54f6964ca8ea6ffa465c27b691593c8">More...</a><br /></td></tr>
<tr class="separator:af54f6964ca8ea6ffa465c27b691593c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a49860a7322876075728b1e3bab271f03"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; byte &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_h_k_d_s_server.html#a49860a7322876075728b1e3bab271f03">GenerateEdk</a> (const std::vector&lt; byte &gt; &amp;Mdk, const std::vector&lt; byte &gt; &amp;DeviceId)</td></tr>
<tr class="memdesc:a49860a7322876075728b1e3bab271f03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a device key  <a href="class_h_k_d_s_server.html#a49860a7322876075728b1e3bab271f03">More...</a><br /></td></tr>
<tr class="separator:a49860a7322876075728b1e3bab271f03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1169c087987ef5ac3d4a8823be17e13e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_h_k_d_s_server.html#a1169c087987ef5ac3d4a8823be17e13e">GenerateMdk</a> (<a class="el" href="group___enumeration.html#ga28cc9721f2d40df0b609ba25b5da9706">ShakeModes</a> Mode, <a class="el" href="class_h_k_d_s_master_key.html">HKDSMasterKey</a> &amp;Mdk, const std::vector&lt; byte &gt; &amp;Kid)</td></tr>
<tr class="memdesc:a1169c087987ef5ac3d4a8823be17e13e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate the HKDS key structure  <a href="class_h_k_d_s_server.html#a1169c087987ef5ac3d4a8823be17e13e">More...</a><br /></td></tr>
<tr class="separator:a1169c087987ef5ac3d4a8823be17e13e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Hierarchal Key Distribution System Server (HKDS-SERVER) </p>
<p>Server decrypts a client message </p><div class="fragment"><div class="line"><span class="comment">// initialize the server with the client-ksn and master key</span></div>
<div class="line"><a class="code" href="class_h_k_d_s_server.html">HKDSServer</a> srv(mdk, <a class="code" href="class_h_k_d_s_server.html#ae205d1f4c5eb4e72279c7a0b515af462">KSN</a>);</div>
<div class="line"><span class="comment">// server decrypts the message</span></div>
<div class="line">srv.Decrypt(ctxt, ptxt);</div>
</div><!-- fragment --><p>Create a clients device id </p><div class="fragment"><div class="line"><span class="comment">// generate the clients embedded key</span></div>
<div class="line">dk = <a class="code" href="class_h_k_d_s_server.html#a49860a7322876075728b1e3bab271f03">HKDSServer::GenerateEdk</a>(mdk.BDK, did);</div>
</div><!-- fragment --> <p><b></b> </p>
<p>Implementation Notes: </p>
<p>The HKDS key management protocol, utilized in conjunction with the Keccak family of message authentication code generators(KMAC), and extended output functions(SHAKE), is used to derive unique symmetric keys employed to protect messaging in a financial services environment. The security of a distributed key scheme is directly tied to the secure derivation of transaction keys, used to encrypt a message cryptogram. This specification presents a distributed key management protocol that generates unique transaction keys from a base terminal key, in such a way that:</p>
<ul>
<li>
The terminal does not retain information that could be used to reconstruct the key once the transaction has been completed(forward security). </li>
<li>
The capture of the terminals state, does not provide enough information to construct future derived keys(predicative resistance). </li>
<li>
The server can reconstruct the transaction key using a bonded number of cryptographic operations. </li>
</ul>
<p>HKDS is a two-key system.It uses an embedded key on the client to encrypt token exchanges and as a portion of the key used to generate the transaction key cache.It also uses a token key; an ephemeral key derived by the server, encrypted and sent to the client, as the second part of the key used to initialize the PRF that generates the transaction key cache. There are numerous advantages to using two keys in this way:</p>
<ul>
<li>
The client’s embedded device key need never be updated, the base token key can be updated instead, to inject new entropy into the system. </li>
<li>
The client can produce a practically unlimited number of derived transaction keys, there is no upper limit, so long as the base token key is periodically refreshed (after many thousands of token derivations, or millions of transactions). </li>
<li>
This method provides both forward security, and predictive resistance. Even if the client’s state is captured, the adversary will not be able to derive past key caches from the information contained in the state. Likewise, the adversary will not be able to derive future key caches based on the captured state alone. </li>
<li>
The client’s key can be changed, without changing the embedded key itself (which is usually stored in a tamper-proof module, and can only be changed via direct access to the terminal). The client’s master key identity can be changed instead, pointing to a different master key, that derives the same embedded device key, but uses a different base secret token. </li>
<li>
Performance: HKDS is highly efficient, outperforming DUKPT-AES by 4 times the decryption speed with a 128-bit key, to as much as 8 times faster than DUKPT using a 256-bit key, and we believe if using embedded Keccak CPU instructions, the performance of HKDS can be vastly improved upon. </li>
<li>
Security: HKDS can be implemented with 128, 256, and 512-bit security settings, and uses strong standardized(KMAC) authentication. </li>
</ul>
<p>Guiding Publications: </p><ol>
<li>
FIPS 202: <a href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf">Permutation Based Hash</a> and Extendable Output Functions </li>
<li>
NIST <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-185.pdf">SP800-185</a> SHA-3 Derived Functions. </li>
<li>
Team Keccak <a href="https://keccak.team/index.html">Homepage</a>. </li>
</ol>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a950c4e337bd9046b41ae17d0005f71fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a950c4e337bd9046b41ae17d0005f71fb">&#9670;&nbsp;</a></span>HKDSServer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HKDSServer::HKDSServer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_h_k_d_s_master_key.html">HKDSMasterKey</a> &amp;&#160;</td>
          <td class="paramname"><em>Mdk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; byte &gt; &amp;&#160;</td>
          <td class="paramname"><em>Ksn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The HKDS server constructor </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Mdk</td><td>The base derivation key</td></tr>
    <tr><td class="paramname">Ksn</td><td>The clients identity string</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae849569e80f7a5b6e6d40b9410990658"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae849569e80f7a5b6e6d40b9410990658">&#9670;&nbsp;</a></span>~HKDSServer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HKDSServer::~HKDSServer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finalize and destroy state </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a8c36fde2cba1a02ffe651562ded1a5f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c36fde2cba1a02ffe651562ded1a5f4">&#9670;&nbsp;</a></span>Decrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HKDSServer::Decrypt </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; byte &gt; &amp;&#160;</td>
          <td class="paramname"><em>Input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; byte &gt; &amp;&#160;</td>
          <td class="paramname"><em>Output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypt a message from the client </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Input</td><td>The clients message cipher-text</td></tr>
    <tr><td class="paramname">Output</td><td>The client message plain-text</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">CryptoKmsException</td><td>Thrown if the cipher-text size is invalid</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7eb8c1a72d4ddce496908dc8959dc040"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7eb8c1a72d4ddce496908dc8959dc040">&#9670;&nbsp;</a></span>DecryptVerify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; byte &gt; HKDSServer::DecryptVerify </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; byte &gt; &amp;&#160;</td>
          <td class="paramname"><em>CipherText</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; byte &gt; &amp;&#160;</td>
          <td class="paramname"><em>AdditionalData</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verify a ciphertext's integrity with a keyed MAC, if verified return the decrypted PIN message. </p>
<p>This function uses KMAC to verify the cipher-text integrity before decrypting the message. An optional data can be added to the MAC update, such as the originating clients IP address. If the MAC verifies the cipher-text, the message is decrypted and returned by this function. If the MAC authentication check fails, a CryptoAuthenticationFailure exception is thrown.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CipherText</td><td>The cipher-text with the appended MAC code</td></tr>
    <tr><td class="paramname">AdditionalData</td><td>The optional additional data used in authentication</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>On success returns decrypted PIN message, on failure throws an exception</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">CryptoAuthenticationFailure</td><td>Thrown before decryption if the the ciphertext fails authentication</td></tr>
    <tr><td class="paramname">CryptoKmsException</td><td>Thrown if the cipher-text size is invalid</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af54f6964ca8ea6ffa465c27b691593c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af54f6964ca8ea6ffa465c27b691593c8">&#9670;&nbsp;</a></span>EncryptToken()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; byte &gt; HKDSServer::EncryptToken </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypt the token key </p>
<dl class="section return"><dt>Returns</dt><dd>The encrypted token key</dd></dl>

</div>
</div>
<a id="aa39fd72c9529f4706d6c1b763e2c1ce1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa39fd72c9529f4706d6c1b763e2c1ce1">&#9670;&nbsp;</a></span>Enumeral()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="group___enumeration.html#ga463c29a8bffdd0c01e8579147b26c725">Kms</a> HKDSServer::Enumeral </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read Only: The KMS server type name </p>

</div>
</div>
<a id="a49860a7322876075728b1e3bab271f03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49860a7322876075728b1e3bab271f03">&#9670;&nbsp;</a></span>GenerateEdk()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; byte &gt; HKDSServer::GenerateEdk </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; byte &gt; &amp;&#160;</td>
          <td class="paramname"><em>Mdk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; byte &gt; &amp;&#160;</td>
          <td class="paramname"><em>DeviceId</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generate a device key </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Mdk</td><td>The base derivation key</td></tr>
    <tr><td class="paramname">DeviceId</td><td>The device identity string</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The device key</dd></dl>

</div>
</div>
<a id="a1169c087987ef5ac3d4a8823be17e13e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1169c087987ef5ac3d4a8823be17e13e">&#9670;&nbsp;</a></span>GenerateMdk()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void HKDSServer::GenerateMdk </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___enumeration.html#ga28cc9721f2d40df0b609ba25b5da9706">ShakeModes</a>&#160;</td>
          <td class="paramname"><em>Mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_h_k_d_s_master_key.html">HKDSMasterKey</a> &amp;&#160;</td>
          <td class="paramname"><em>Mdk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; byte &gt; &amp;&#160;</td>
          <td class="paramname"><em>Kid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generate the HKDS key structure </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Mode</td><td>The SHAKE mode</td></tr>
    <tr><td class="paramname">Mdk</td><td>The master key structure</td></tr>
    <tr><td class="paramname">Kid</td><td>The master keys identity string</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="acab0a5694372b8e724666a8778f988da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acab0a5694372b8e724666a8778f988da">&#9670;&nbsp;</a></span>KeyCacheSize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const size_t HKDSServer::KeyCacheSize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read Only: The number of keys in a full cache </p>

</div>
</div>
<a id="ae205d1f4c5eb4e72279c7a0b515af462"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae205d1f4c5eb4e72279c7a0b515af462">&#9670;&nbsp;</a></span>KSN()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; byte &gt; &amp; HKDSServer::KSN </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read/Write: The clients key serial number </p>

</div>
</div>
<a id="a5180f98c4bdb330ceba5c945e673da90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5180f98c4bdb330ceba5c945e673da90">&#9670;&nbsp;</a></span>Name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const std::string HKDSServer::Name </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read Only: The KMS formal implementation name </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>C:/Users/stepp/Documents/Develop/Github/CEX++/CEX/<a class="el" href="_h_k_d_s_server_8h_source.html">HKDSServer.h</a></li>
<li>C:/Users/stepp/Documents/Develop/Github/CEX++/CEX/HKDSServer.cpp</li>
</ul>
</div><!-- contents -->
<div class="ttc" id="aclass_h_k_d_s_server_html_a49860a7322876075728b1e3bab271f03"><div class="ttname"><a href="class_h_k_d_s_server.html#a49860a7322876075728b1e3bab271f03">HKDSServer::GenerateEdk</a></div><div class="ttdeci">static std::vector&lt; byte &gt; GenerateEdk(const std::vector&lt; byte &gt; &amp;Mdk, const std::vector&lt; byte &gt; &amp;DeviceId)</div><div class="ttdoc">Generate a device key</div><div class="ttdef"><b>Definition:</b> HKDSServer.cpp:298</div></div>
<div class="ttc" id="aclass_h_k_d_s_server_html"><div class="ttname"><a href="class_h_k_d_s_server.html">HKDSServer</a></div><div class="ttdoc">Hierarchal Key Distribution System Server (HKDS-SERVER)</div><div class="ttdef"><b>Definition:</b> HKDSServer.h:97</div></div>
<div class="ttc" id="aclass_h_k_d_s_server_html_ae205d1f4c5eb4e72279c7a0b515af462"><div class="ttname"><a href="class_h_k_d_s_server.html#ae205d1f4c5eb4e72279c7a0b515af462">HKDSServer::KSN</a></div><div class="ttdeci">std::vector&lt; byte &gt; &amp; KSN()</div><div class="ttdoc">Read/Write: The clients key serial number</div><div class="ttdef"><b>Definition:</b> HKDSServer.cpp:168</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.18
</small></address>
</body>
</html>
